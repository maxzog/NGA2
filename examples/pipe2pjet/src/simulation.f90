!> Various definitions and tools for running an NGA2 simulation
module simulation
   use precision,         only: WP
!   use geometry,          only: cfg
   use parallel,          only: rank, amRoot, group, comm
   use hypre_str_class,   only: hypre_str
   use fft3d_class,       only: fft3d
   use fft2d_class,       only: fft2d
   use config_class,      only: config
   use ddadi_class,       only: ddadi
   use incomp_class,      only: incomp
   use lpt_class,         only: lpt
   use timetracker_class, only: timetracker
   use ensight_class,     only: ensight
   use partmesh_class,    only: partmesh
   use event_class,       only: event
   use monitor_class,     only: monitor
   use datafile_class,    only: datafile
   use string,            only: str_medium
   use coupler_class,     only: coupler
   use mpi_f08,           only: MPI_GROUP, MPI_UNDEFINED
   implicit none
   private
   
   !> TODO: add some more stuff here
   public :: simulation_init,simulation_run,simulation_final
   type(timetracker) :: time
   type(event)    :: ens_evt
   type(datafile) :: df
   type(MPI_GROUP) :: pipegrp

   ! General domain type definition
   type :: gendomain
     character(len=str_medium) :: desc
     type(config) :: cfg
     type(incomp) :: fs
     real(WP) :: cfl, meanU, meanV, meanW
     real(WP), dimension(:,:,:), allocatable :: resU, resV, resW, Ui, Vi, Wi
     real(WP), dimension(:,:,:,:), allocatable :: SR
     real(WP), dimension(:,:,:,:), allocatable :: vort
     real(WP), dimension(:,:,:,:,:), allocatable :: gradu
     type(monitor)  :: mfile, cflfile, simfile
     type(ensight)  :: ens_out     
   end type gendomain

   type, extends(gendomain) :: pipedomain
     type(fft3d) :: ps
     type(hypre_str) :: vs
     real(WP), dimension(:,:,:), allocatable :: G
     real(WP) :: visc,mfr_target,mfr,bforce
     real(WP) :: Qbulk
   end type pipedomain

   type, extends(gendomain) :: pjetdomain
     type(hypre_str)   :: ps
     ! type(fft2d)       :: ps
     type(ddadi)       :: vs
   end type pjetdomain

   type(pjetdomain) :: pjet
   type(pipedomain) :: pipe

   type(coupler) :: dom_cpl
    
   !> Fluid, forcing, and particle parameters
   real(WP) :: visc
   real(WP) :: stk,tau_eta
   logical  :: use_sgs
   integer  :: sgs_type

   !> Jet parameters
   real(WP) :: Djet        ! Jet diameter
   real(WP) :: Qt,Q0       ! Volumetric flow rates (time, max)
   real(WP) :: U0          ! Bulk velocity 
   real(WP) :: Uco         ! Coflow velocity 
   real(WP) :: omegaj,tauj ! Pulse frequency and decay rate
   real(WP) :: theta       ! Jet inlet momentum thickness
   
   real(WP), public :: dt_dat      ! Time step in flow rate data
   real(WP), dimension(:), allocatable, public :: tdat,qdat ! Flow rate data (time [SEC] and flow rate [SLM])
   
   integer, dimension(3) :: pipepart
   integer, dimension(3) :: pjetpart
   integer :: pipeRank
   logical :: inpipeGrp

 contains
      
   subroutine allocate_flowrate
      implicit none
      ! Allocate work arrays
      allocate(tdat(1500))
      allocate(qdat(1500))
   end subroutine allocate_flowrate
   
   subroutine define_flowrate
      implicit none
      qdat = [0.01690000_WP, 0.01694463_WP, 0.05083389_WP, 0.10166778_WP, 0.16944630_WP, 0.25416945_WP, 0.35583722_WP, 0.47444963_WP, 0.61000667_WP, 0.76250834_WP, 0.93195464_WP, 1.10140093_WP, 1.27084723_WP, 1.44029353_WP, 1.60973983_WP, 1.77963576_WP, 1.99449500_WP, 2.25431755_WP, 2.55910340_WP, 2.90885257_WP, 3.30356504_WP, 3.74324083_WP, 4.22787992_WP, 4.75748232_WP, 5.33204803_WP, 5.95112742_WP, 6.57020680_WP, 7.18928619_WP, 7.80836558_WP, 8.42744496_WP, 9.04901935_WP, 9.79534356_WP, 10.66641761_WP, 11.66224149_WP, 12.78281521_WP, 14.02813876_WP, 15.39821214_WP, 16.89303536_WP, 18.48501001_WP, 20.14916611_WP, 21.88300867_WP, 23.56428286_WP, 25.19298866_WP, 26.76912608_WP, 28.29269513_WP, 29.76234290_WP, 31.13432555_WP, 32.40864310_WP, 33.61289393_WP, 34.77204803_WP, 35.88610540_WP, 36.95506604_WP, 37.97892995_WP, 39.00081121_WP, 40.05818279_WP, 41.15239760_WP, 42.32719947_WP, 43.58258839_WP, 44.91856438_WP, 46.33512742_WP, 47.83067111_WP, 49.36664176_WP, 50.94303936_WP, 52.51674983_WP, 54.05030020_WP, 55.54369046_WP, 56.99692061_WP, 58.40999066_WP, 59.89451835_WP, 61.54368913_WP, 63.35910941_WP, 65.37933289_WP, 67.60435957_WP, 70.03418946_WP, 72.66882255_WP, 75.50082722_WP, 78.38900267_WP, 81.33334890_WP, 84.22224817_WP, 86.96251501_WP, 89.55414943_WP, 91.99715143_WP, 94.29152101_WP, 96.39268045_WP, 98.26488726_WP, 99.91557305_WP, 101.48593863_WP, 102.97598399_WP, 104.38570914_WP, 105.71511408_WP, 106.96632021_WP, 108.17256304_WP, 109.33384256_WP, 110.49473649_WP, 111.69098732_WP, 112.92259506_WP, 114.18955971_WP, 115.49188125_WP, 116.79435557_WP, 118.06987859_WP, 119.31632889_WP, 120.50047098_WP, 121.62230487_WP, 122.68183055_WP, 123.67904803_WP, 124.62019613_WP, 125.58816211_WP, 126.58294596_WP, 127.63975183_WP, 128.78568379_WP, 130.02074183_WP, 131.34492595_WP, 132.75823616_WP, 134.21080587_WP, 135.66577718_WP, 137.11691127_WP, 138.48132088_WP, 139.75900600_WP, 140.94996664_WP, 142.05420280_WP, 143.06889660_WP, 143.96164243_WP, 144.73244029_WP, 145.43115677_WP, 146.09464977_WP, 146.72291928_WP, 147.31596531_WP, 147.87378786_WP, 148.39966511_WP, 148.89592262_WP, 149.36537825_WP, 149.84043763_WP, 150.32110073_WP, 150.80736758_WP, 151.29923816_WP, 151.79426284_WP, 152.26767312_WP, 152.71946898_WP, 153.14637225_WP, 153.54605737_WP, 153.91852435_WP, 154.26377318_WP, 154.58180387_WP, 154.89611474_WP, 155.22270047_WP, 155.56401067_WP, 155.94481388_WP, 156.36511007_WP, 156.82489927_WP, 157.32418145_WP, 157.85959440_WP, 158.40087792_WP, 158.94803202_WP, 159.47755837_WP, 159.97346231_WP, 160.43574383_WP, 160.86440294_WP, 161.25943963_WP, 161.61754436_WP, 161.93655637_WP, 162.21983789_WP, 162.49764910_WP, 162.76998999_WP, 163.03686057_WP, 163.29826084_WP, 163.55498332_WP, 163.81344029_WP, 164.07363175_WP, 164.33886724_WP, 164.61130754_WP, 164.89095264_WP, 165.17780254_WP, 165.47185724_WP, 165.76253169_WP, 166.04319947_WP, 166.31306805_WP, 166.56572515_WP, 166.80117078_WP, 167.01940494_WP, 167.22042762_WP, 167.40627218_WP, 167.59184990_WP, 167.77716077_WP, 167.97278986_WP, 168.18536358_WP, 168.41488192_WP, 168.66134490_WP, 168.92475250_WP, 169.19534823_WP, 169.46727819_WP, 169.73850901_WP, 169.99412942_WP, 170.23413943_WP, 170.45853903_WP, 170.66732822_WP, 170.85958773_WP, 171.02916544_WP, 171.17606137_WP, 171.31003202_WP, 171.43693129_WP, 171.55675917_WP, 171.66951568_WP, 171.77520080_WP, 171.88398132_WP, 172.00170113_WP, 172.12927952_WP, 172.27286858_WP, 172.43246831_WP, 172.60807872_WP, 172.79969980_WP, 173.00652835_WP, 173.22363042_WP, 173.45100600_WP, 173.67848833_WP, 173.90023349_WP, 174.11624149_WP, 174.32651234_WP, 174.53104603_WP, 174.72734690_WP, 174.91404136_WP, 175.09193262_WP, 175.26595464_WP, 175.43610740_WP, 175.60239093_WP, 175.76480520_WP, 175.92399066_WP, 176.08357638_WP, 176.24356237_WP, 176.40644430_WP, 176.57359573_WP, 176.74501668_WP, 176.92070714_WP, 177.10066711_WP, 177.29223749_WP, 177.49928486_WP, 177.72116878_WP, 177.95426017_WP, 178.19855904_WP, 178.45406538_WP, 178.72077919_WP, 178.99515677_WP, 179.25859373_WP, 179.51109006_WP, 179.74530487_WP, 179.95737158_WP, 180.14729019_WP, 180.31506071_WP, 180.46068312_WP, 180.58460107_WP, 180.68703803_WP, 180.77153769_WP, 180.85670447_WP, 180.94253836_WP, 181.02903936_WP, 181.11620747_WP, 181.20640160_WP, 181.31113876_WP, 181.43041895_WP, 181.56379853_WP, 181.71105404_WP, 181.87218546_WP, 182.04719280_WP, 182.23607605_WP, 182.43271114_WP, 182.63414943_WP, 182.83803202_WP, 183.03284189_WP, 183.21857905_WP, 183.39524350_WP, 183.56283522_WP, 183.72164243_WP, 183.87297799_WP, 184.01684189_WP, 184.15935824_WP, 184.30347565_WP, 184.44919413_WP, 184.59651368_WP, 184.74543429_WP, 184.90582655_WP, 185.08222949_WP, 185.27435490_WP, 185.48088993_WP, 185.70183456_WP, 185.93718879_WP, 186.18695264_WP, 186.44570113_WP, 186.69030687_WP, 186.92076985_WP, 187.12721948_WP, 187.30511674_WP, 187.45446164_WP, 187.57525417_WP, 187.66749433_WP, 187.73776584_WP, 187.78895797_WP, 187.82649566_WP, 187.87350634_WP, 187.92998999_WP, 187.99594663_WP, 188.07137625_WP, 188.15593195_WP, 188.24822615_WP, 188.34825884_WP, 188.44944630_WP, 188.54889927_WP, 188.64661775_WP, 188.74260173_WP, 188.83685123_WP, 188.92964843_WP, 189.02111141_WP, 189.11158706_WP, 189.20246298_WP, 189.29373916_WP, 189.38541561_WP, 189.47749233_WP, 189.57008139_WP, 189.66360440_WP, 189.75806137_WP, 189.85317011_WP, 189.94881254_WP, 190.04498866_WP, 190.14169847_WP, 190.23894196_WP, 190.32994596_WP, 190.41201067_WP, 190.48502402_WP, 190.54856438_WP, 190.60263175_WP, 190.64722615_WP, 190.68234757_WP, 190.70911141_WP, 190.73147231_WP, 190.74943029_WP, 190.76975851_WP, 190.79515677_WP, 190.82562508_WP, 190.86116344_WP, 190.90177185_WP, 190.95064243_WP, 191.00898599_WP, 191.07568712_WP, 191.14679119_WP, 191.22229820_WP, 191.30220814_WP, 191.38652101_WP, 191.47404003_WP, 191.56075851_WP, 191.64667645_WP, 191.72860173_WP, 191.80532355_WP, 191.87684189_WP, 191.94315677_WP, 192.00426818_WP, 192.06762909_WP, 192.13592662_WP, 192.21035757_WP, 192.29492862_WP, 192.38963976_WP, 192.49449099_WP, 192.60948232_WP, 192.73390927_WP, 192.86554103_WP, 193.00437759_WP, 193.14296598_WP, 193.27861908_WP, 193.41133689_WP, 193.54111941_WP, 193.66796664_WP, 193.78820080_WP, 193.90056304_WP, 194.00575784_WP, 194.10601601_WP, 194.20133756_WP, 194.29172248_WP, 194.37717078_WP, 194.45684857_WP, 194.52825417_WP, 194.59138759_WP, 194.64992662_WP, 194.70513009_WP, 194.75699800_WP, 194.80553035_WP, 194.85072715_WP, 194.89550967_WP, 194.94082588_WP, 194.98750967_WP, 195.03806271_WP, 195.09248499_WP, 195.15077652_WP, 195.21293729_WP, 195.27757972_WP, 195.34075450_WP, 195.40246164_WP, 195.45977985_WP, 195.51176117_WP, 195.55840560_WP, 195.59971314_WP, 195.63568379_WP, 195.66376584_WP, 195.68317545_WP, 195.69530020_WP, 195.70408939_WP, 195.70954303_WP, 195.71166111_WP, 195.71044363_WP, 195.70816011_WP, 195.71094663_WP, 195.71880320_WP, 195.73428152_WP, 195.75816544_WP, 195.79045497_WP, 195.83115010_WP, 195.88025083_WP, 195.93155304_WP, 195.98325550_WP, 196.03308873_WP, 196.07491661_WP, 196.10873916_WP, 196.13455637_WP, 196.15236825_WP, 196.16307138_WP, 196.16897131_WP, 196.17006805_WP, 196.17256571_WP, 196.17826551_WP, 196.18716744_WP, 196.19927151_WP, 196.21457772_WP, 196.24649233_WP, 196.29868712_WP, 196.37026551_WP, 196.45892195_WP, 196.56465644_WP, 196.68746898_WP, 196.82735957_WP, 196.98161975_WP, 197.14361841_WP, 197.31335557_WP, 197.47742495_WP, 197.63215477_WP, 197.77754503_WP, 197.91359573_WP, 198.04030687_WP, 198.15417812_WP, 198.25430687_WP, 198.34340160_WP, 198.42809340_WP, 198.50838225_WP, 198.58426818_WP, 198.65575117_WP, 198.72379186_WP, 198.79063175_WP, 198.85627085_WP, 198.92420947_WP, 198.99535023_WP, 199.06969313_WP, 199.14723816_WP, 199.22798532_WP, 199.30355704_WP, 199.37192395_WP, 199.43212542_WP, 199.48191995_WP, 199.52130754_WP, 199.55028819_WP, 199.56886191_WP, 199.57525017_WP, 199.56549433_WP, 199.53959440_WP, 199.50592795_WP, 199.46652435_WP, 199.42138359_WP, 199.37050567_WP, 199.31389059_WP, 199.25512675_WP, 199.19502869_WP, 199.13537492_WP, 199.08012408_WP, 199.02927618_WP, 198.98283122_WP, 198.94078919_WP, 198.89977718_WP, 198.85262775_WP, 198.79934089_WP, 198.73632822_WP, 198.66277518_WP, 198.57868179_WP, 198.48404803_WP, 198.37887392_WP, 198.27262575_WP, 198.16731154_WP, 198.06630420_WP, 197.97677118_WP, 197.89871247_WP, 197.83212809_WP, 197.77701801_WP, 197.73523149_WP, 197.71052302_WP, 197.70289260_WP, 197.70287392_WP, 197.70845897_WP, 197.71964777_WP, 197.73644029_WP, 197.75883656_WP, 197.80053969_WP, 197.86425751_WP, 197.94814076_WP, 198.04843496_WP, 198.16514009_WP, 198.29825617_WP, 198.44778319_WP, 198.60909406_WP, 198.77320680_WP, 198.94012141_WP, 199.09613476_WP, 199.23853903_WP, 199.36733422_WP, 199.48252035_WP, 199.58409740_WP, 199.66642829_WP, 199.72847899_WP, 199.77487658_WP, 199.81460307_WP, 199.84765844_WP, 199.87404270_WP, 199.89375584_WP, 199.89166778_WP, 199.83967979_WP, 199.73779186_WP, 199.59164109_WP, 199.40226151_WP, 199.16965310_WP, 198.89381588_WP, 198.57474983_WP, 198.20606671_WP, 197.78668312_WP, 197.33172915_WP, 196.86930354_WP, 196.39940627_WP, 195.92203736_WP, 195.43719680_WP, 194.94651768_WP, 194.45290327_WP, 193.95635357_WP, 193.46325684_WP, 192.97469646_WP, 192.49067245_WP, 192.01118479_WP, 191.53623349_WP, 190.99437959_WP, 190.37447365_WP, 189.67488259_WP, 188.89270314_WP, 188.02793529_WP, 187.08057905_WP, 186.05063442_WP, 184.95350367_WP, 183.81541227_WP, 182.63636024_WP, 181.48778652_WP, 180.38084056_WP, 179.31552235_WP, 178.29183189_WP, 177.30976918_WP, 176.39256638_WP, 175.54354236_WP, 174.74729486_WP, 173.97759840_WP, 173.23445297_WP, 172.51785857_WP, 171.82781521_WP, 171.12781855_WP, 170.35830887_WP, 169.51928619_WP, 168.58751835_WP, 167.55968646_WP, 166.43579053_WP, 165.21583055_WP, 163.89980654_WP, 162.54191661_WP, 161.14920347_WP, 159.75817145_WP, 158.42838025_WP, 157.15982989_WP, 155.95252035_WP, 154.80645163_WP, 153.73426818_WP, 152.75574716_WP, 151.87088859_WP, 151.02549433_WP, 150.21252168_WP, 149.43197065_WP, 148.68384123_WP, 147.96813342_WP, 147.25320280_WP, 146.53533689_WP, 145.80189126_WP, 145.03308873_WP, 144.22892929_WP, 143.38941294_WP, 142.51453969_WP, 141.57650434_WP, 140.53359907_WP, 139.38582388_WP, 138.16482322_WP, 136.87430954_WP, 135.51428286_WP, 134.08474316_WP, 132.58569046_WP, 131.10563242_WP, 129.65385991_WP, 128.25817812_WP, 126.96029486_WP, 125.76021014_WP, 124.65792395_WP, 123.65343629_WP, 122.73454837_WP, 121.88370580_WP, 121.10090861_WP, 120.29764910_WP, 119.46463642_WP, 118.60187058_WP, 117.70935157_WP, 116.78707939_WP, 115.77877452_WP, 114.67920881_WP, 113.50058105_WP, 112.26044563_WP, 110.95880254_WP, 109.59565177_WP, 108.17099333_WP, 106.72629486_WP, 105.31882121_WP, 103.94857238_WP, 102.67182789_WP, 101.49381588_WP, 100.41453636_WP, 99.43398933_WP, 98.55217478_WP, 97.73749833_WP, 96.98739827_WP, 96.26040694_WP, 95.49925951_WP, 94.70395597_WP, 93.87449633_WP, 93.01088059_WP, 92.12584523_WP, 91.23627352_WP, 90.34216544_WP, 89.47511541_WP, 88.63768512_WP, 87.82987458_WP, 87.05168379_WP, 86.30311274_WP, 85.50881254_WP, 84.66354503_WP, 83.75457372_WP, 82.76501534_WP, 81.69486991_WP, 80.54413742_WP, 79.31281788_WP, 78.02867912_WP, 76.72706204_WP, 75.40796664_WP, 74.14674183_WP, 72.94862575_WP, 71.81361841_WP, 70.74171981_WP, 69.73292995_WP, 68.81965243_WP, 68.00377318_WP, 67.25752435_WP, 66.54556504_WP, 65.86789526_WP, 65.22451501_WP, 64.61542428_WP, 64.00357839_WP, 63.34370047_WP, 62.63579053_WP, 61.84744496_WP, 60.97677785_WP, 60.02378919_WP, 58.98847899_WP, 57.87084723_WP, 56.72746765_WP, 55.56100600_WP, 54.40850700_WP, 53.31524750_WP, 52.28122748_WP, 51.30644696_WP, 50.39090594_WP, 49.54700200_WP, 48.78928886_WP, 48.11776651_WP, 47.47586124_WP, 46.86090727_WP, 46.27290460_WP, 45.71185324_WP, 45.17775317_WP, 44.60004803_WP, 43.97617879_WP, 43.29374783_WP, 42.53820147_WP, 41.70953969_WP, 40.80776251_WP, 39.83286991_WP, 38.80793863_WP, 37.75899133_WP, 36.68602802_WP, 35.65960507_WP, 34.68228152_WP, 33.75405737_WP, 32.87493262_WP, 32.04490727_WP, 31.28206338_WP, 30.58686458_WP, 29.93623416_WP, 29.30414943_WP, 28.69061041_WP, 28.09561708_WP, 27.51916945_WP, 26.93059106_WP, 26.29664910_WP, 25.61734356_WP, 24.87459239_WP, 24.06793195_WP, 23.19736224_WP, 22.26288326_WP, 21.26449500_WP, 20.25463442_WP, 19.23410007_WP, 18.23356838_WP, 17.28627218_WP, 16.39221147_WP, 15.55138626_WP, 14.76379653_WP, 14.04147165_WP, 13.39693195_WP, 12.83017745_WP, 12.28877118_WP, 11.77191461_WP, 11.27960774_WP, 10.81185057_WP, 10.36864310_WP, 9.94932155_WP, 9.55388259_WP, 9.17029686_WP, 8.78604403_WP, 8.40112408_WP, 8.01553702_WP, 7.62928286_WP, 7.25203469_WP, 6.89346564_WP, 6.55357572_WP, 6.23302869_WP, 5.93182789_WP, 5.64997332_WP, 5.38746498_WP, 5.14449099_WP, 4.95848833_WP, 4.82945697_WP, 4.74772382_WP, 4.70361574_WP, 4.69713276_WP, 4.72827485_WP, 4.79704203_WP, 4.90772115_WP, 5.06443095_WP, 5.26698332_WP, 5.47794129_WP, 5.69730487_WP, 5.92507405_WP, 6.16124883_WP, 6.40639960_WP, 6.69798132_WP, 7.03599400_WP, 7.41615077_WP, 7.83433289_WP, 8.29054036_WP, 8.78477318_WP, 9.31703135_WP, 9.86317078_WP, 10.40090460_WP, 10.92966244_WP, 11.41198933_WP, 11.84788526_WP, 12.23735023_WP, 12.58038426_WP, 12.87706404_WP, 13.13038159_WP, 13.34033689_WP, 13.53107405_WP, 13.72487992_WP, 13.92175450_WP, 14.12169780_WP, 14.32470981_WP, 14.53432622_WP, 14.75368245_WP, 14.98270180_WP, 15.21839226_WP, 15.46075384_WP, 15.70978652_WP, 15.96549033_WP, 16.22707605_WP, 16.47278452_WP, 16.70261574_WP, 16.91303402_WP, 17.10090394_WP, 17.26622548_WP, 17.40899867_WP, 17.52922348_WP, 17.62682789_WP, 17.70175050_WP, 17.75478052_WP, 17.80767712_WP, 17.86044029_WP, 17.91307005_WP, 17.96556638_WP, 18.01777318_WP, 18.06637759_WP, 18.11137959_WP, 18.15285123_WP, 18.19085390_WP, 18.22538759_WP, 18.25645230_WP, 18.28404803_WP, 18.30567979_WP, 18.31930620_WP, 18.32508339_WP, 18.32632422_WP, 18.32302869_WP, 18.31519680_WP, 18.30282855_WP, 18.28576985_WP, 18.26137292_WP, 18.22963776_WP, 18.19305937_WP, 18.15367912_WP, 18.11149700_WP, 18.06651301_WP, 18.01872715_WP, 17.96821414_WP, 17.91503269_WP, 17.85933689_WP, 17.80377452_WP, 17.74834556_WP, 17.69305003_WP, 17.63788793_WP, 17.58170580_WP, 17.50791194_WP, 17.41650634_WP, 17.30741428_WP, 17.18057705_WP, 17.03599466_WP, 16.87366711_WP, 16.69359440_WP, 16.50003536_WP, 16.29620280_WP, 16.08325017_WP, 15.87776918_WP, 15.67975984_WP, 15.48922215_WP, 15.30615610_WP, 15.13076184_WP, 14.96550767_WP, 14.81039360_WP, 14.66116077_WP, 14.51459640_WP, 14.37070047_WP, 14.22947298_WP, 14.09091394_WP, 13.94357038_WP, 13.77914877_WP, 13.59744897_WP, 13.39600267_WP, 13.17480987_WP, 12.93387058_WP, 12.67318479_WP, 12.39389793_WP, 12.10834023_WP, 11.81651167_WP, 11.52986524_WP, 11.25669446_WP, 10.99699933_WP, 10.75077985_WP, 10.51803602_WP, 10.30199533_WP, 10.10490060_WP, 9.92560640_WP, 9.75178252_WP, 9.58342895_WP, 9.42054570_WP, 9.26313276_WP, 9.10949166_WP, 8.94344229_WP, 8.76498466_WP, 8.57089126_WP, 8.35891928_WP, 8.12906871_WP, 7.88133956_WP, 7.61573182_WP, 7.34057105_WP, 7.06140761_WP, 6.77993996_WP, 6.51234823_WP, 6.25863242_WP, 6.01879253_WP, 5.79282855_WP, 5.58142695_WP, 5.39043896_WP, 5.21986458_WP, 5.06137825_WP, 4.90942962_WP, 4.76401868_WP, 4.62514543_WP, 4.49280987_WP, 4.35879186_WP, 4.21783589_WP, 4.06925550_WP, 3.90719947_WP, 3.73166778_WP, 3.54266044_WP, 3.34017745_WP, 3.12612141_WP, 2.91513409_WP, 2.70721548_WP, 2.51058572_WP, 2.33050033_WP, 2.16695931_WP, 2.01996264_WP, 1.88951034_WP, 1.77907672_WP, 1.69079119_WP, 1.62275117_WP, 1.56031488_WP, 1.50348232_WP, 1.45225350_WP, 1.40662842_WP, 1.36760774_WP, 1.34219613_WP, 1.33039360_WP, 1.32872582_WP, 1.33506338_WP, 1.34940627_WP, 1.37175450_WP, 1.40210807_WP, 1.44164376_WP, 1.49105270_WP, 1.54933422_WP, 1.60948366_WP, 1.67150100_WP, 1.73538626_WP, 1.80113943_WP, 1.86861641_WP, 1.93689393_WP, 2.00597198_WP, 2.07467378_WP, 2.14230821_WP, 2.20887525_WP, 2.27437492_WP, 2.33880720_WP, 2.40823482_WP, 2.48606805_WP, 2.57245097_WP, 2.66830687_WP, 2.77363576_WP, 2.88843763_WP, 3.01271247_WP, 3.14566711_WP, 3.28262442_WP, 3.42358439_WP, 3.56248432_WP, 3.69591394_WP, 3.82387325_WP, 3.94636224_WP, 4.06338092_WP, 4.17302135_WP, 4.27425617_WP, 4.36787859_WP, 4.45856571_WP, 4.54631755_WP, 4.63113409_WP, 4.71301534_WP, 4.79194063_WP, 4.86779720_WP, 4.94058506_WP, 5.01221214_WP, 5.08370580_WP, 5.15506604_WP, 5.22629286_WP, 5.29738626_WP, 5.36517612_WP, 5.42802935_WP, 5.48596664_WP, 5.53910073_WP, 5.58743162_WP, 5.63095931_WP, 5.66968379_WP, 5.70296664_WP, 5.72757705_WP, 5.74351501_WP, 5.75395063_WP, 5.76051701_WP, 5.76321414_WP, 5.76204203_WP, 5.75700067_WP, 5.74782188_WP, 5.73437358_WP, 5.71729420_WP, 5.69981454_WP, 5.68193462_WP, 5.66365444_WP, 5.64497398_WP, 5.62593996_WP, 5.60677252_WP, 5.58747165_WP, 5.56830554_WP, 5.54940627_WP, 5.53077385_WP, 5.51240827_WP, 5.49430954_WP, 5.47620547_WP, 5.45796798_WP, 5.43955037_WP, 5.42073249_WP, 5.40151434_WP, 5.38189593_WP, 5.36187725_WP, 5.34071781_WP, 5.31515544_WP, 5.28519013_WP, 5.25109406_WP, 5.21299533_WP, 5.17089393_WP, 5.12478986_WP, 5.07468312_WP, 5.02167845_WP, 4.96627218_WP, 4.90920480_WP, 4.85373849_WP, 4.79987325_WP, 4.74760907_WP, 4.69694596_WP, 4.64822215_WP, 4.60283389_WP, 4.56078119_WP, 4.52095931_WP, 4.48287191_WP, 4.44651901_WP, 4.41190060_WP, 4.37901668_WP, 4.34562575_WP, 4.31076718_WP, 4.27410274_WP, 4.23423616_WP, 4.19116744_WP, 4.14489660_WP, 4.09542362_WP, 4.04318612_WP, 3.98988125_WP, 3.93550901_WP, 3.88231087_WP, 3.83124750_WP, 3.78231888_WP, 3.73552502_WP, 3.69086591_WP, 3.64947832_WP, 3.61182655_WP, 3.57747298_WP, 3.54472048_WP, 3.51356905_WP, 3.48401868_WP, 3.45606938_WP, 3.42886057_WP, 3.39925017_WP, 3.36723816_WP, 3.33168779_WP, 3.29213476_WP, 3.24857905_WP, 3.20102068_WP, 3.14945964_WP, 3.09600934_WP, 3.04149166_WP, 2.98676718_WP, 2.93497799_WP, 2.88612408_WP, 2.84020547_WP, 2.79722215_WP, 2.75747432_WP, 2.72199600_WP, 2.69078719_WP, 2.66173449_WP, 2.63401601_WP, 2.60763175_WP, 2.58258172_WP, 2.55886591_WP, 2.53492595_WP, 2.51018546_WP, 2.48434423_WP, 2.45636825_WP, 2.42625751_WP, 2.39401201_WP, 2.35963175_WP, 2.32355570_WP, 2.28721281_WP, 2.25060307_WP, 2.21528486_WP, 2.18183456_WP, 2.15025217_WP, 2.12053769_WP, 2.09269113_WP, 2.06730487_WP, 2.04458706_WP, 2.02409873_WP, 2.00441094_WP, 1.98552368_WP, 1.96743696_WP, 1.95015077_WP, 1.93304403_WP, 1.91420280_WP, 1.89362708_WP, 1.87072448_WP, 1.84528686_WP, 1.81731421_WP, 1.78680654_WP, 1.75376384_WP, 1.71948699_WP, 1.68440961_WP, 1.64915277_WP, 1.61563042_WP, 1.58384256_WP, 1.55378919_WP, 1.52547031_WP, 1.49912408_WP, 1.47544630_WP, 1.45443696_WP, 1.43479520_WP, 1.41608739_WP, 1.39831354_WP, 1.38147365_WP, 1.36556771_WP, 1.34927752_WP, 1.33218679_WP, 1.31405737_WP, 1.29419346_WP, 1.27259506_WP, 1.24926217_WP, 1.22419480_WP, 1.19781721_WP, 1.17130620_WP, 1.14466177_WP, 1.11920213_WP, 1.09534356_WP, 1.07308606_WP, 1.05242962_WP, 1.03337425_WP, 1.01643362_WP, 1.00176117_WP, 0.98893262_WP, 0.97677118_WP, 0.96527685_WP, 0.95444963_WP, 0.94428953_WP, 0.93475984_WP, 0.92576384_WP, 0.91730153_WP, 0.90885924_WP, 0.90028352_WP, 0.89157438_WP, 0.88273182_WP, 0.87375584_WP, 0.86464643_WP, 0.85540360_WP, 0.84606404_WP, 0.83672448_WP, 0.82738492_WP, 0.81804536_WP, 0.80870580_WP, 0.79955637_WP, 0.79107405_WP, 0.78325884_WP, 0.77611074_WP, 0.76962975_WP, 0.76381588_WP, 0.75866911_WP, 0.75418946_WP, 0.75037692_WP, 0.74723149_WP, 0.74456304_WP, 0.74189460_WP, 0.73922615_WP, 0.73655771_WP, 0.73388926_WP, 0.73129953_WP, 0.72897665_WP, 0.72692061_WP, 0.72513142_WP, 0.72360907_WP, 0.72235357_WP, 0.72136491_WP, 0.72064310_WP, 0.72029486_WP, 0.72034690_WP, 0.72072048_WP, 0.72122748_WP, 0.72186791_WP, 0.72264176_WP, 0.72354903_WP, 0.72454903_WP, 0.72554903_WP, 0.72654903_WP, 0.72744229_WP, 0.72820213_WP, 0.72882855_WP, 0.72932155_WP, 0.72968112_WP, 0.73001534_WP, 0.73034957_WP, 0.73072448_WP, 0.73123282_WP, 0.73187458_WP, 0.73264977_WP, 0.73355837_WP, 0.73455837_WP, 0.73555837_WP, 0.73655837_WP, 0.73745030_WP, 0.73820881_WP, 0.73883389_WP, 0.73932555_WP, 0.73968379_WP, 0.73990861_WP, 0.74000000_WP, 0.74000000_WP, 0.74000000_WP, 0.74000000_WP, 0.74000000_WP, 0.74000000_WP, 0.73995664_WP, 0.73977985_WP, 0.73946965_WP, 0.73902602_WP, 0.73844897_WP, 0.73773849_WP, 0.73689460_WP, 0.73591728_WP, 0.73480654_WP, 0.73356237_WP, 0.73222815_WP, 0.73089393_WP, 0.72955971_WP, 0.72822548_WP, 0.72689126_WP, 0.72555704_WP, 0.72422282_WP, 0.72288859_WP, 0.72155437_WP, 0.72022015_WP, 0.71888592_WP, 0.71755170_WP, 0.71621748_WP, 0.71499533_WP, 0.71390660_WP, 0.71295130_WP, 0.71212942_WP, 0.71144096_WP, 0.71088592_WP, 0.71046431_WP, 0.71013009_WP, 0.70979586_WP, 0.70946164_WP, 0.70901534_WP, 0.70843562_WP, 0.70772248_WP, 0.70687592_WP, 0.70589593_WP, 0.70478252_WP, 0.70353569_WP, 0.70220147_WP, 0.70086724_WP, 0.69953302_WP, 0.69819880_WP, 0.69686458_WP, 0.69553035_WP, 0.69419613_WP, 0.69286191_WP, 0.69152769_WP, 0.69019346_WP, 0.68885924_WP, 0.68752502_WP, 0.68619079_WP, 0.68485657_WP, 0.68352235_WP, 0.68218813_WP, 0.68085390_WP, 0.67951968_WP, 0.67818546_WP, 0.67685123_WP, 0.67551701_WP, 0.67418279_WP, 0.67284857_WP, 0.67151434_WP, 0.67018012_WP, 0.66884590_WP, 0.66751167_WP, 0.66617745_WP, 0.66484323_WP, 0.66350901_WP, 0.66217478_WP, 0.66084056_WP, 0.65950634_WP, 0.65817211_WP, 0.65683789_WP, 0.65550367_WP, 0.65416945_WP, 0.65283522_WP, 0.65150100_WP, 0.65016678_WP, 0.64883256_WP, 0.64749833_WP, 0.64616411_WP, 0.64482989_WP, 0.64349566_WP, 0.64216144_WP, 0.64082722_WP, 0.63949300_WP, 0.63815877_WP, 0.63682455_WP, 0.63549033_WP, 0.63415610_WP, 0.63282188_WP, 0.63148766_WP, 0.63015344_WP, 0.62881921_WP, 0.62748499_WP, 0.62615077_WP, 0.62481654_WP, 0.62348232_WP, 0.62214810_WP, 0.62081388_WP, 0.61947965_WP, 0.61814543_WP, 0.61681121_WP, 0.61547698_WP, 0.61414276_WP, 0.61280854_WP, 0.61147432_WP, 0.61014009_WP, 0.60880587_WP, 0.60747165_WP, 0.60613742_WP, 0.60492328_WP, 0.60384256_WP, 0.60289526_WP, 0.60208139_WP, 0.60140093_WP, 0.60085390_WP, 0.60044029_WP, 0.60005203_WP, 0.59953035_WP, 0.59887525_WP, 0.59796664_WP, 0.59679119_WP, 0.59534890_WP, 0.59363976_WP, 0.59166378_WP, 0.58954236_WP, 0.58728753_WP, 0.58500734_WP, 0.58286057_WP, 0.58084723_WP, 0.57896731_WP, 0.57722081_WP, 0.57566311_WP, 0.57437225_WP, 0.57334823_WP, 0.57246965_WP, 0.57172448_WP, 0.57111274_WP, 0.57063442_WP, 0.57028953_WP, 0.56995530_WP, 0.56962108_WP, 0.56923149_WP, 0.56870847_WP, 0.56805203_WP, 0.56726217_WP, 0.56633889_WP, 0.56522548_WP, 0.56384523_WP, 0.56219813_WP, 0.56040694_WP, 0.55848232_WP, 0.55642428_WP, 0.55423282_WP, 0.55190794_WP, 0.54969780_WP, 0.54762108_WP, 0.54573449_WP, 0.54411474_WP, 0.54276184_WP, 0.54167578_WP, 0.54085657_WP, 0.54024616_WP, 0.53976918_WP, 0.53942562_WP, 0.53896731_WP, 0.53837558_WP, 0.53765043_WP, 0.53679186_WP, 0.53579987_WP, 0.53467445_WP, 0.53341561_WP, 0.53208139_WP, 0.53074716_WP, 0.52941294_WP, 0.52807872_WP, 0.52674450_WP, 0.52546965_WP, 0.52432822_WP, 0.52332021_WP, 0.52244563_WP, 0.52170447_WP, 0.52109673_WP, 0.52062241_WP, 0.52028152_WP, 0.52007405_WP, 0.52000000_WP, 0.52000000_WP, 0.52000000_WP, 0.52000000_WP, 0.52000000_WP, 0.52000000_WP, 0.51993929_WP, 0.51974516_WP, 0.51941761_WP, 0.51895664_WP, 0.51836224_WP, 0.51763442_WP, 0.51677318_WP, 0.51577852_WP, 0.51465043_WP, 0.51338893_WP, 0.51205470_WP, 0.51072048_WP, 0.50938626_WP, 0.50805203_WP, 0.50671781_WP, 0.50544563_WP, 0.50430687_WP, 0.50330153_WP, 0.50242962_WP, 0.50169113_WP, 0.50108606_WP, 0.50061441_WP, 0.50027618_WP, 0.50007138_WP, 0.50000000_WP, 0.50000000_WP, 0.50000000_WP, 0.50000000_WP, 0.50000000_WP, 0.50000000_WP, 0.49993662_WP, 0.49973983_WP, 0.49940961_WP, 0.49894596_WP, 0.49834890_WP, 0.49761841_WP, 0.49675450_WP, 0.49575717_WP, 0.49475717_WP, 0.49375717_WP, 0.49282055_WP, 0.49201734_WP, 0.49134757_WP, 0.49081121_WP, 0.49040827_WP, 0.49013876_WP, 0.49000267_WP, 0.49000000_WP, 0.49000000_WP, 0.49000000_WP, 0.49000000_WP, 0.49000000_WP, 0.49000000_WP, 0.48986791_WP, 0.48960240_WP, 0.48920347_WP, 0.48867111_WP, 0.48800534_WP, 0.48720614_WP, 0.48627352_WP, 0.48527352_WP, 0.48427352_WP, 0.48327352_WP, 0.48240560_WP, 0.48167111_WP, 0.48107005_WP, 0.48060240_WP, 0.43226818_WP]
      tdat = [0.00000000_WP, 0.00026684_WP, 0.00053369_WP, 0.00080053_WP, 0.00106738_WP, 0.00133422_WP, 0.00160107_WP, 0.00186791_WP, 0.00213476_WP, 0.00240160_WP, 0.00266845_WP, 0.00293529_WP, 0.00320213_WP, 0.00346898_WP, 0.00373582_WP, 0.00400267_WP, 0.00426951_WP, 0.00453636_WP, 0.00480320_WP, 0.00507005_WP, 0.00533689_WP, 0.00560374_WP, 0.00587058_WP, 0.00613742_WP, 0.00640427_WP, 0.00667111_WP, 0.00693796_WP, 0.00720480_WP, 0.00747165_WP, 0.00773849_WP, 0.00800534_WP, 0.00827218_WP, 0.00853903_WP, 0.00880587_WP, 0.00907272_WP, 0.00933956_WP, 0.00960640_WP, 0.00987325_WP, 0.01014009_WP, 0.01040694_WP, 0.01067378_WP, 0.01094063_WP, 0.01120747_WP, 0.01147432_WP, 0.01174116_WP, 0.01200801_WP, 0.01227485_WP, 0.01254169_WP, 0.01280854_WP, 0.01307538_WP, 0.01334223_WP, 0.01360907_WP, 0.01387592_WP, 0.01414276_WP, 0.01440961_WP, 0.01467645_WP, 0.01494330_WP, 0.01521014_WP, 0.01547698_WP, 0.01574383_WP, 0.01601067_WP, 0.01627752_WP, 0.01654436_WP, 0.01681121_WP, 0.01707805_WP, 0.01734490_WP, 0.01761174_WP, 0.01787859_WP, 0.01814543_WP, 0.01841227_WP, 0.01867912_WP, 0.01894596_WP, 0.01921281_WP, 0.01947965_WP, 0.01974650_WP, 0.02001334_WP, 0.02028019_WP, 0.02054703_WP, 0.02081388_WP, 0.02108072_WP, 0.02134757_WP, 0.02161441_WP, 0.02188125_WP, 0.02214810_WP, 0.02241494_WP, 0.02268179_WP, 0.02294863_WP, 0.02321548_WP, 0.02348232_WP, 0.02374917_WP, 0.02401601_WP, 0.02428286_WP, 0.02454970_WP, 0.02481654_WP, 0.02508339_WP, 0.02535023_WP, 0.02561708_WP, 0.02588392_WP, 0.02615077_WP, 0.02641761_WP, 0.02668446_WP, 0.02695130_WP, 0.02721815_WP, 0.02748499_WP, 0.02775183_WP, 0.02801868_WP, 0.02828552_WP, 0.02855237_WP, 0.02881921_WP, 0.02908606_WP, 0.02935290_WP, 0.02961975_WP, 0.02988659_WP, 0.03015344_WP, 0.03042028_WP, 0.03068712_WP, 0.03095397_WP, 0.03122081_WP, 0.03148766_WP, 0.03175450_WP, 0.03202135_WP, 0.03228819_WP, 0.03255504_WP, 0.03282188_WP, 0.03308873_WP, 0.03335557_WP, 0.03362241_WP, 0.03388926_WP, 0.03415610_WP, 0.03442295_WP, 0.03468979_WP, 0.03495664_WP, 0.03522348_WP, 0.03549033_WP, 0.03575717_WP, 0.03602402_WP, 0.03629086_WP, 0.03655771_WP, 0.03682455_WP, 0.03709139_WP, 0.03735824_WP, 0.03762508_WP, 0.03789193_WP, 0.03815877_WP, 0.03842562_WP, 0.03869246_WP, 0.03895931_WP, 0.03922615_WP, 0.03949300_WP, 0.03975984_WP, 0.04002668_WP, 0.04029353_WP, 0.04056037_WP, 0.04082722_WP, 0.04109406_WP, 0.04136091_WP, 0.04162775_WP, 0.04189460_WP, 0.04216144_WP, 0.04242829_WP, 0.04269513_WP, 0.04296197_WP, 0.04322882_WP, 0.04349566_WP, 0.04376251_WP, 0.04402935_WP, 0.04429620_WP, 0.04456304_WP, 0.04482989_WP, 0.04509673_WP, 0.04536358_WP, 0.04563042_WP, 0.04589726_WP, 0.04616411_WP, 0.04643095_WP, 0.04669780_WP, 0.04696464_WP, 0.04723149_WP, 0.04749833_WP, 0.04776518_WP, 0.04803202_WP, 0.04829887_WP, 0.04856571_WP, 0.04883256_WP, 0.04909940_WP, 0.04936624_WP, 0.04963309_WP, 0.04989993_WP, 0.05016678_WP, 0.05043362_WP, 0.05070047_WP, 0.05096731_WP, 0.05123416_WP, 0.05150100_WP, 0.05176785_WP, 0.05203469_WP, 0.05230153_WP, 0.05256838_WP, 0.05283522_WP, 0.05310207_WP, 0.05336891_WP, 0.05363576_WP, 0.05390260_WP, 0.05416945_WP, 0.05443629_WP, 0.05470314_WP, 0.05496998_WP, 0.05523682_WP, 0.05550367_WP, 0.05577051_WP, 0.05603736_WP, 0.05630420_WP, 0.05657105_WP, 0.05683789_WP, 0.05710474_WP, 0.05737158_WP, 0.05763843_WP, 0.05790527_WP, 0.05817211_WP, 0.05843896_WP, 0.05870580_WP, 0.05897265_WP, 0.05923949_WP, 0.05950634_WP, 0.05977318_WP, 0.06004003_WP, 0.06030687_WP, 0.06057372_WP, 0.06084056_WP, 0.06110740_WP, 0.06137425_WP, 0.06164109_WP, 0.06190794_WP, 0.06217478_WP, 0.06244163_WP, 0.06270847_WP, 0.06297532_WP, 0.06324216_WP, 0.06350901_WP, 0.06377585_WP, 0.06404270_WP, 0.06430954_WP, 0.06457638_WP, 0.06484323_WP, 0.06511007_WP, 0.06537692_WP, 0.06564376_WP, 0.06591061_WP, 0.06617745_WP, 0.06644430_WP, 0.06671114_WP, 0.06697799_WP, 0.06724483_WP, 0.06751167_WP, 0.06777852_WP, 0.06804536_WP, 0.06831221_WP, 0.06857905_WP, 0.06884590_WP, 0.06911274_WP, 0.06937959_WP, 0.06964643_WP, 0.06991328_WP, 0.07018012_WP, 0.07044696_WP, 0.07071381_WP, 0.07098065_WP, 0.07124750_WP, 0.07151434_WP, 0.07178119_WP, 0.07204803_WP, 0.07231488_WP, 0.07258172_WP, 0.07284857_WP, 0.07311541_WP, 0.07338225_WP, 0.07364910_WP, 0.07391594_WP, 0.07418279_WP, 0.07444963_WP, 0.07471648_WP, 0.07498332_WP, 0.07525017_WP, 0.07551701_WP, 0.07578386_WP, 0.07605070_WP, 0.07631755_WP, 0.07658439_WP, 0.07685123_WP, 0.07711808_WP, 0.07738492_WP, 0.07765177_WP, 0.07791861_WP, 0.07818546_WP, 0.07845230_WP, 0.07871915_WP, 0.07898599_WP, 0.07925284_WP, 0.07951968_WP, 0.07978652_WP, 0.08005337_WP, 0.08032021_WP, 0.08058706_WP, 0.08085390_WP, 0.08112075_WP, 0.08138759_WP, 0.08165444_WP, 0.08192128_WP, 0.08218813_WP, 0.08245497_WP, 0.08272181_WP, 0.08298866_WP, 0.08325550_WP, 0.08352235_WP, 0.08378919_WP, 0.08405604_WP, 0.08432288_WP, 0.08458973_WP, 0.08485657_WP, 0.08512342_WP, 0.08539026_WP, 0.08565710_WP, 0.08592395_WP, 0.08619079_WP, 0.08645764_WP, 0.08672448_WP, 0.08699133_WP, 0.08725817_WP, 0.08752502_WP, 0.08779186_WP, 0.08805871_WP, 0.08832555_WP, 0.08859239_WP, 0.08885924_WP, 0.08912608_WP, 0.08939293_WP, 0.08965977_WP, 0.08992662_WP, 0.09019346_WP, 0.09046031_WP, 0.09072715_WP, 0.09099400_WP, 0.09126084_WP, 0.09152769_WP, 0.09179453_WP, 0.09206137_WP, 0.09232822_WP, 0.09259506_WP, 0.09286191_WP, 0.09312875_WP, 0.09339560_WP, 0.09366244_WP, 0.09392929_WP, 0.09419613_WP, 0.09446298_WP, 0.09472982_WP, 0.09499666_WP, 0.09526351_WP, 0.09553035_WP, 0.09579720_WP, 0.09606404_WP, 0.09633089_WP, 0.09659773_WP, 0.09686458_WP, 0.09713142_WP, 0.09739827_WP, 0.09766511_WP, 0.09793195_WP, 0.09819880_WP, 0.09846564_WP, 0.09873249_WP, 0.09899933_WP, 0.09926618_WP, 0.09953302_WP, 0.09979987_WP, 0.10006671_WP, 0.10033356_WP, 0.10060040_WP, 0.10086724_WP, 0.10113409_WP, 0.10140093_WP, 0.10166778_WP, 0.10193462_WP, 0.10220147_WP, 0.10246831_WP, 0.10273516_WP, 0.10300200_WP, 0.10326885_WP, 0.10353569_WP, 0.10380254_WP, 0.10406938_WP, 0.10433622_WP, 0.10460307_WP, 0.10486991_WP, 0.10513676_WP, 0.10540360_WP, 0.10567045_WP, 0.10593729_WP, 0.10620414_WP, 0.10647098_WP, 0.10673783_WP, 0.10700467_WP, 0.10727151_WP, 0.10753836_WP, 0.10780520_WP, 0.10807205_WP, 0.10833889_WP, 0.10860574_WP, 0.10887258_WP, 0.10913943_WP, 0.10940627_WP, 0.10967312_WP, 0.10993996_WP, 0.11020680_WP, 0.11047365_WP, 0.11074049_WP, 0.11100734_WP, 0.11127418_WP, 0.11154103_WP, 0.11180787_WP, 0.11207472_WP, 0.11234156_WP, 0.11260841_WP, 0.11287525_WP, 0.11314209_WP, 0.11340894_WP, 0.11367578_WP, 0.11394263_WP, 0.11420947_WP, 0.11447632_WP, 0.11474316_WP, 0.11501001_WP, 0.11527685_WP, 0.11554370_WP, 0.11581054_WP, 0.11607738_WP, 0.11634423_WP, 0.11661107_WP, 0.11687792_WP, 0.11714476_WP, 0.11741161_WP, 0.11767845_WP, 0.11794530_WP, 0.11821214_WP, 0.11847899_WP, 0.11874583_WP, 0.11901268_WP, 0.11927952_WP, 0.11954636_WP, 0.11981321_WP, 0.12008005_WP, 0.12034690_WP, 0.12061374_WP, 0.12088059_WP, 0.12114743_WP, 0.12141428_WP, 0.12168112_WP, 0.12194797_WP, 0.12221481_WP, 0.12248165_WP, 0.12274850_WP, 0.12301534_WP, 0.12328219_WP, 0.12354903_WP, 0.12381588_WP, 0.12408272_WP, 0.12434957_WP, 0.12461641_WP, 0.12488326_WP, 0.12515010_WP, 0.12541694_WP, 0.12568379_WP, 0.12595063_WP, 0.12621748_WP, 0.12648432_WP, 0.12675117_WP, 0.12701801_WP, 0.12728486_WP, 0.12755170_WP, 0.12781855_WP, 0.12808539_WP, 0.12835223_WP, 0.12861908_WP, 0.12888592_WP, 0.12915277_WP, 0.12941961_WP, 0.12968646_WP, 0.12995330_WP, 0.13022015_WP, 0.13048699_WP, 0.13075384_WP, 0.13102068_WP, 0.13128753_WP, 0.13155437_WP, 0.13182121_WP, 0.13208806_WP, 0.13235490_WP, 0.13262175_WP, 0.13288859_WP, 0.13315544_WP, 0.13342228_WP, 0.13368913_WP, 0.13395597_WP, 0.13422282_WP, 0.13448966_WP, 0.13475650_WP, 0.13502335_WP, 0.13529019_WP, 0.13555704_WP, 0.13582388_WP, 0.13609073_WP, 0.13635757_WP, 0.13662442_WP, 0.13689126_WP, 0.13715811_WP, 0.13742495_WP, 0.13769179_WP, 0.13795864_WP, 0.13822548_WP, 0.13849233_WP, 0.13875917_WP, 0.13902602_WP, 0.13929286_WP, 0.13955971_WP, 0.13982655_WP, 0.14009340_WP, 0.14036024_WP, 0.14062708_WP, 0.14089393_WP, 0.14116077_WP, 0.14142762_WP, 0.14169446_WP, 0.14196131_WP, 0.14222815_WP, 0.14249500_WP, 0.14276184_WP, 0.14302869_WP, 0.14329553_WP, 0.14356237_WP, 0.14382922_WP, 0.14409606_WP, 0.14436291_WP, 0.14462975_WP, 0.14489660_WP, 0.14516344_WP, 0.14543029_WP, 0.14569713_WP, 0.14596398_WP, 0.14623082_WP, 0.14649767_WP, 0.14676451_WP, 0.14703135_WP, 0.14729820_WP, 0.14756504_WP, 0.14783189_WP, 0.14809873_WP, 0.14836558_WP, 0.14863242_WP, 0.14889927_WP, 0.14916611_WP, 0.14943296_WP, 0.14969980_WP, 0.14996664_WP, 0.15023349_WP, 0.15050033_WP, 0.15076718_WP, 0.15103402_WP, 0.15130087_WP, 0.15156771_WP, 0.15183456_WP, 0.15210140_WP, 0.15236825_WP, 0.15263509_WP, 0.15290193_WP, 0.15316878_WP, 0.15343562_WP, 0.15370247_WP, 0.15396931_WP, 0.15423616_WP, 0.15450300_WP, 0.15476985_WP, 0.15503669_WP, 0.15530354_WP, 0.15557038_WP, 0.15583722_WP, 0.15610407_WP, 0.15637091_WP, 0.15663776_WP, 0.15690460_WP, 0.15717145_WP, 0.15743829_WP, 0.15770514_WP, 0.15797198_WP, 0.15823883_WP, 0.15850567_WP, 0.15877252_WP, 0.15903936_WP, 0.15930620_WP, 0.15957305_WP, 0.15983989_WP, 0.16010674_WP, 0.16037358_WP, 0.16064043_WP, 0.16090727_WP, 0.16117412_WP, 0.16144096_WP, 0.16170781_WP, 0.16197465_WP, 0.16224149_WP, 0.16250834_WP, 0.16277518_WP, 0.16304203_WP, 0.16330887_WP, 0.16357572_WP, 0.16384256_WP, 0.16410941_WP, 0.16437625_WP, 0.16464310_WP, 0.16490994_WP, 0.16517678_WP, 0.16544363_WP, 0.16571047_WP, 0.16597732_WP, 0.16624416_WP, 0.16651101_WP, 0.16677785_WP, 0.16704470_WP, 0.16731154_WP, 0.16757839_WP, 0.16784523_WP, 0.16811207_WP, 0.16837892_WP, 0.16864576_WP, 0.16891261_WP, 0.16917945_WP, 0.16944630_WP, 0.16971314_WP, 0.16997999_WP, 0.17024683_WP, 0.17051368_WP, 0.17078052_WP, 0.17104736_WP, 0.17131421_WP, 0.17158105_WP, 0.17184790_WP, 0.17211474_WP, 0.17238159_WP, 0.17264843_WP, 0.17291528_WP, 0.17318212_WP, 0.17344897_WP, 0.17371581_WP, 0.17398266_WP, 0.17424950_WP, 0.17451634_WP, 0.17478319_WP, 0.17505003_WP, 0.17531688_WP, 0.17558372_WP, 0.17585057_WP, 0.17611741_WP, 0.17638426_WP, 0.17665110_WP, 0.17691795_WP, 0.17718479_WP, 0.17745163_WP, 0.17771848_WP, 0.17798532_WP, 0.17825217_WP, 0.17851901_WP, 0.17878586_WP, 0.17905270_WP, 0.17931955_WP, 0.17958639_WP, 0.17985324_WP, 0.18012008_WP, 0.18038692_WP, 0.18065377_WP, 0.18092061_WP, 0.18118746_WP, 0.18145430_WP, 0.18172115_WP, 0.18198799_WP, 0.18225484_WP, 0.18252168_WP, 0.18278853_WP, 0.18305537_WP, 0.18332221_WP, 0.18358906_WP, 0.18385590_WP, 0.18412275_WP, 0.18438959_WP, 0.18465644_WP, 0.18492328_WP, 0.18519013_WP, 0.18545697_WP, 0.18572382_WP, 0.18599066_WP, 0.18625751_WP, 0.18652435_WP, 0.18679119_WP, 0.18705804_WP, 0.18732488_WP, 0.18759173_WP, 0.18785857_WP, 0.18812542_WP, 0.18839226_WP, 0.18865911_WP, 0.18892595_WP, 0.18919280_WP, 0.18945964_WP, 0.18972648_WP, 0.18999333_WP, 0.19026017_WP, 0.19052702_WP, 0.19079386_WP, 0.19106071_WP, 0.19132755_WP, 0.19159440_WP, 0.19186124_WP, 0.19212809_WP, 0.19239493_WP, 0.19266177_WP, 0.19292862_WP, 0.19319546_WP, 0.19346231_WP, 0.19372915_WP, 0.19399600_WP, 0.19426284_WP, 0.19452969_WP, 0.19479653_WP, 0.19506338_WP, 0.19533022_WP, 0.19559706_WP, 0.19586391_WP, 0.19613075_WP, 0.19639760_WP, 0.19666444_WP, 0.19693129_WP, 0.19719813_WP, 0.19746498_WP, 0.19773182_WP, 0.19799867_WP, 0.19826551_WP, 0.19853235_WP, 0.19879920_WP, 0.19906604_WP, 0.19933289_WP, 0.19959973_WP, 0.19986658_WP, 0.20013342_WP, 0.20040027_WP, 0.20066711_WP, 0.20093396_WP, 0.20120080_WP, 0.20146765_WP, 0.20173449_WP, 0.20200133_WP, 0.20226818_WP, 0.20253502_WP, 0.20280187_WP, 0.20306871_WP, 0.20333556_WP, 0.20360240_WP, 0.20386925_WP, 0.20413609_WP, 0.20440294_WP, 0.20466978_WP, 0.20493662_WP, 0.20520347_WP, 0.20547031_WP, 0.20573716_WP, 0.20600400_WP, 0.20627085_WP, 0.20653769_WP, 0.20680454_WP, 0.20707138_WP, 0.20733823_WP, 0.20760507_WP, 0.20787191_WP, 0.20813876_WP, 0.20840560_WP, 0.20867245_WP, 0.20893929_WP, 0.20920614_WP, 0.20947298_WP, 0.20973983_WP, 0.21000667_WP, 0.21027352_WP, 0.21054036_WP, 0.21080720_WP, 0.21107405_WP, 0.21134089_WP, 0.21160774_WP, 0.21187458_WP, 0.21214143_WP, 0.21240827_WP, 0.21267512_WP, 0.21294196_WP, 0.21320881_WP, 0.21347565_WP, 0.21374249_WP, 0.21400934_WP, 0.21427618_WP, 0.21454303_WP, 0.21480987_WP, 0.21507672_WP, 0.21534356_WP, 0.21561041_WP, 0.21587725_WP, 0.21614410_WP, 0.21641094_WP, 0.21667779_WP, 0.21694463_WP, 0.21721147_WP, 0.21747832_WP, 0.21774516_WP, 0.21801201_WP, 0.21827885_WP, 0.21854570_WP, 0.21881254_WP, 0.21907939_WP, 0.21934623_WP, 0.21961308_WP, 0.21987992_WP, 0.22014676_WP, 0.22041361_WP, 0.22068045_WP, 0.22094730_WP, 0.22121414_WP, 0.22148099_WP, 0.22174783_WP, 0.22201468_WP, 0.22228152_WP, 0.22254837_WP, 0.22281521_WP, 0.22308205_WP, 0.22334890_WP, 0.22361574_WP, 0.22388259_WP, 0.22414943_WP, 0.22441628_WP, 0.22468312_WP, 0.22494997_WP, 0.22521681_WP, 0.22548366_WP, 0.22575050_WP, 0.22601734_WP, 0.22628419_WP, 0.22655103_WP, 0.22681788_WP, 0.22708472_WP, 0.22735157_WP, 0.22761841_WP, 0.22788526_WP, 0.22815210_WP, 0.22841895_WP, 0.22868579_WP, 0.22895264_WP, 0.22921948_WP, 0.22948632_WP, 0.22975317_WP, 0.23002001_WP, 0.23028686_WP, 0.23055370_WP, 0.23082055_WP, 0.23108739_WP, 0.23135424_WP, 0.23162108_WP, 0.23188793_WP, 0.23215477_WP, 0.23242161_WP, 0.23268846_WP, 0.23295530_WP, 0.23322215_WP, 0.23348899_WP, 0.23375584_WP, 0.23402268_WP, 0.23428953_WP, 0.23455637_WP, 0.23482322_WP, 0.23509006_WP, 0.23535690_WP, 0.23562375_WP, 0.23589059_WP, 0.23615744_WP, 0.23642428_WP, 0.23669113_WP, 0.23695797_WP, 0.23722482_WP, 0.23749166_WP, 0.23775851_WP, 0.23802535_WP, 0.23829219_WP, 0.23855904_WP, 0.23882588_WP, 0.23909273_WP, 0.23935957_WP, 0.23962642_WP, 0.23989326_WP, 0.24016011_WP, 0.24042695_WP, 0.24069380_WP, 0.24096064_WP, 0.24122748_WP, 0.24149433_WP, 0.24176117_WP, 0.24202802_WP, 0.24229486_WP, 0.24256171_WP, 0.24282855_WP, 0.24309540_WP, 0.24336224_WP, 0.24362909_WP, 0.24389593_WP, 0.24416278_WP, 0.24442962_WP, 0.24469646_WP, 0.24496331_WP, 0.24523015_WP, 0.24549700_WP, 0.24576384_WP, 0.24603069_WP, 0.24629753_WP, 0.24656438_WP, 0.24683122_WP, 0.24709807_WP, 0.24736491_WP, 0.24763175_WP, 0.24789860_WP, 0.24816544_WP, 0.24843229_WP, 0.24869913_WP, 0.24896598_WP, 0.24923282_WP, 0.24949967_WP, 0.24976651_WP, 0.25003336_WP, 0.25030020_WP, 0.25056704_WP, 0.25083389_WP, 0.25110073_WP, 0.25136758_WP, 0.25163442_WP, 0.25190127_WP, 0.25216811_WP, 0.25243496_WP, 0.25270180_WP, 0.25296865_WP, 0.25323549_WP, 0.25350233_WP, 0.25376918_WP, 0.25403602_WP, 0.25430287_WP, 0.25456971_WP, 0.25483656_WP, 0.25510340_WP, 0.25537025_WP, 0.25563709_WP, 0.25590394_WP, 0.25617078_WP, 0.25643763_WP, 0.25670447_WP, 0.25697131_WP, 0.25723816_WP, 0.25750500_WP, 0.25777185_WP, 0.25803869_WP, 0.25830554_WP, 0.25857238_WP, 0.25883923_WP, 0.25910607_WP, 0.25937292_WP, 0.25963976_WP, 0.25990660_WP, 0.26017345_WP, 0.26044029_WP, 0.26070714_WP, 0.26097398_WP, 0.26124083_WP, 0.26150767_WP, 0.26177452_WP, 0.26204136_WP, 0.26230821_WP, 0.26257505_WP, 0.26284189_WP, 0.26310874_WP, 0.26337558_WP, 0.26364243_WP, 0.26390927_WP, 0.26417612_WP, 0.26444296_WP, 0.26470981_WP, 0.26497665_WP, 0.26524350_WP, 0.26551034_WP, 0.26577718_WP, 0.26604403_WP, 0.26631087_WP, 0.26657772_WP, 0.26684456_WP, 0.26711141_WP, 0.26737825_WP, 0.26764510_WP, 0.26791194_WP, 0.26817879_WP, 0.26844563_WP, 0.26871247_WP, 0.26897932_WP, 0.26924616_WP, 0.26951301_WP, 0.26977985_WP, 0.27004670_WP, 0.27031354_WP, 0.27058039_WP, 0.27084723_WP, 0.27111408_WP, 0.27138092_WP, 0.27164777_WP, 0.27191461_WP, 0.27218145_WP, 0.27244830_WP, 0.27271514_WP, 0.27298199_WP, 0.27324883_WP, 0.27351568_WP, 0.27378252_WP, 0.27404937_WP, 0.27431621_WP, 0.27458306_WP, 0.27484990_WP, 0.27511674_WP, 0.27538359_WP, 0.27565043_WP, 0.27591728_WP, 0.27618412_WP, 0.27645097_WP, 0.27671781_WP, 0.27698466_WP, 0.27725150_WP, 0.27751835_WP, 0.27778519_WP, 0.27805203_WP, 0.27831888_WP, 0.27858572_WP, 0.27885257_WP, 0.27911941_WP, 0.27938626_WP, 0.27965310_WP, 0.27991995_WP, 0.28018679_WP, 0.28045364_WP, 0.28072048_WP, 0.28098732_WP, 0.28125417_WP, 0.28152101_WP, 0.28178786_WP, 0.28205470_WP, 0.28232155_WP, 0.28258839_WP, 0.28285524_WP, 0.28312208_WP, 0.28338893_WP, 0.28365577_WP, 0.28392262_WP, 0.28418946_WP, 0.28445630_WP, 0.28472315_WP, 0.28498999_WP, 0.28525684_WP, 0.28552368_WP, 0.28579053_WP, 0.28605737_WP, 0.28632422_WP, 0.28659106_WP, 0.28685791_WP, 0.28712475_WP, 0.28739159_WP, 0.28765844_WP, 0.28792528_WP, 0.28819213_WP, 0.28845897_WP, 0.28872582_WP, 0.28899266_WP, 0.28925951_WP, 0.28952635_WP, 0.28979320_WP, 0.29006004_WP, 0.29032688_WP, 0.29059373_WP, 0.29086057_WP, 0.29112742_WP, 0.29139426_WP, 0.29166111_WP, 0.29192795_WP, 0.29219480_WP, 0.29246164_WP, 0.29272849_WP, 0.29299533_WP, 0.29326217_WP, 0.29352902_WP, 0.29379586_WP, 0.29406271_WP, 0.29432955_WP, 0.29459640_WP, 0.29486324_WP, 0.29513009_WP, 0.29539693_WP, 0.29566378_WP, 0.29593062_WP, 0.29619746_WP, 0.29646431_WP, 0.29673115_WP, 0.29699800_WP, 0.29726484_WP, 0.29753169_WP, 0.29779853_WP, 0.29806538_WP, 0.29833222_WP, 0.29859907_WP, 0.29886591_WP, 0.29913276_WP, 0.29939960_WP, 0.29966644_WP, 0.29993329_WP, 0.30020013_WP, 0.30046698_WP, 0.30073382_WP, 0.30100067_WP, 0.30126751_WP, 0.30153436_WP, 0.30180120_WP, 0.30206805_WP, 0.30233489_WP, 0.30260173_WP, 0.30286858_WP, 0.30313542_WP, 0.30340227_WP, 0.30366911_WP, 0.30393596_WP, 0.30420280_WP, 0.30446965_WP, 0.30473649_WP, 0.30500334_WP, 0.30527018_WP, 0.30553702_WP, 0.30580387_WP, 0.30607071_WP, 0.30633756_WP, 0.30660440_WP, 0.30687125_WP, 0.30713809_WP, 0.30740494_WP, 0.30767178_WP, 0.30793863_WP, 0.30820547_WP, 0.30847231_WP, 0.30873916_WP, 0.30900600_WP, 0.30927285_WP, 0.30953969_WP, 0.30980654_WP, 0.31007338_WP, 0.31034023_WP, 0.31060707_WP, 0.31087392_WP, 0.31114076_WP, 0.31140761_WP, 0.31167445_WP, 0.31194129_WP, 0.31220814_WP, 0.31247498_WP, 0.31274183_WP, 0.31300867_WP, 0.31327552_WP, 0.31354236_WP, 0.31380921_WP, 0.31407605_WP, 0.31434290_WP, 0.31460974_WP, 0.31487658_WP, 0.31514343_WP, 0.31541027_WP, 0.31567712_WP, 0.31594396_WP, 0.31621081_WP, 0.31647765_WP, 0.31674450_WP, 0.31701134_WP, 0.31727819_WP, 0.31754503_WP, 0.31781187_WP, 0.31807872_WP, 0.31834556_WP, 0.31861241_WP, 0.31887925_WP, 0.31914610_WP, 0.31941294_WP, 0.31967979_WP, 0.31994663_WP, 0.32021348_WP, 0.32048032_WP, 0.32074716_WP, 0.32101401_WP, 0.32128085_WP, 0.32154770_WP, 0.32181454_WP, 0.32208139_WP, 0.32234823_WP, 0.32261508_WP, 0.32288192_WP, 0.32314877_WP, 0.32341561_WP, 0.32368245_WP, 0.32394930_WP, 0.32421614_WP, 0.32448299_WP, 0.32474983_WP, 0.32501668_WP, 0.32528352_WP, 0.32555037_WP, 0.32581721_WP, 0.32608406_WP, 0.32635090_WP, 0.32661775_WP, 0.32688459_WP, 0.32715143_WP, 0.32741828_WP, 0.32768512_WP, 0.32795197_WP, 0.32821881_WP, 0.32848566_WP, 0.32875250_WP, 0.32901935_WP, 0.32928619_WP, 0.32955304_WP, 0.32981988_WP, 0.33008672_WP, 0.33035357_WP, 0.33062041_WP, 0.33088726_WP, 0.33115410_WP, 0.33142095_WP, 0.33168779_WP, 0.33195464_WP, 0.33222148_WP, 0.33248833_WP, 0.33275517_WP, 0.33302201_WP, 0.33328886_WP, 0.33355570_WP, 0.33382255_WP, 0.33408939_WP, 0.33435624_WP, 0.33462308_WP, 0.33488993_WP, 0.33515677_WP, 0.33542362_WP, 0.33569046_WP, 0.33595730_WP, 0.33622415_WP, 0.33649099_WP, 0.33675784_WP, 0.33702468_WP, 0.33729153_WP, 0.33755837_WP, 0.33782522_WP, 0.33809206_WP, 0.33835891_WP, 0.33862575_WP, 0.33889260_WP, 0.33915944_WP, 0.33942628_WP, 0.33969313_WP, 0.33995997_WP, 0.34022682_WP, 0.34049366_WP, 0.34076051_WP, 0.34102735_WP, 0.34129420_WP, 0.34156104_WP, 0.34182789_WP, 0.34209473_WP, 0.34236157_WP, 0.34262842_WP, 0.34289526_WP, 0.34316211_WP, 0.34342895_WP, 0.34369580_WP, 0.34396264_WP, 0.34422949_WP, 0.34449633_WP, 0.34476318_WP, 0.34503002_WP, 0.34529686_WP, 0.34556371_WP, 0.34583055_WP, 0.34609740_WP, 0.34636424_WP, 0.34663109_WP, 0.34689793_WP, 0.34716478_WP, 0.34743162_WP, 0.34769847_WP, 0.34796531_WP, 0.34823215_WP, 0.34849900_WP, 0.34876584_WP, 0.34903269_WP, 0.34929953_WP, 0.34956638_WP, 0.34983322_WP, 0.35010007_WP, 0.35036691_WP, 0.35063376_WP, 0.35090060_WP, 0.35116744_WP, 0.35143429_WP, 0.35170113_WP, 0.35196798_WP, 0.35223482_WP, 0.35250167_WP, 0.35276851_WP, 0.35303536_WP, 0.35330220_WP, 0.35356905_WP, 0.35383589_WP, 0.35410274_WP, 0.35436958_WP, 0.35463642_WP, 0.35490327_WP, 0.35517011_WP, 0.35543696_WP, 0.35570380_WP, 0.35597065_WP, 0.35623749_WP, 0.35650434_WP, 0.35677118_WP, 0.35703803_WP, 0.35730487_WP, 0.35757171_WP, 0.35783856_WP, 0.35810540_WP, 0.35837225_WP, 0.35863909_WP, 0.35890594_WP, 0.35917278_WP, 0.35943963_WP, 0.35970647_WP, 0.35997332_WP, 0.36024016_WP, 0.36050700_WP, 0.36077385_WP, 0.36104069_WP, 0.36130754_WP, 0.36157438_WP, 0.36184123_WP, 0.36210807_WP, 0.36237492_WP, 0.36264176_WP, 0.36290861_WP, 0.36317545_WP, 0.36344229_WP, 0.36370914_WP, 0.36397598_WP, 0.36424283_WP, 0.36450967_WP, 0.36477652_WP, 0.36504336_WP, 0.36531021_WP, 0.36557705_WP, 0.36584390_WP, 0.36611074_WP, 0.36637759_WP, 0.36664443_WP, 0.36691127_WP, 0.36717812_WP, 0.36744496_WP, 0.36771181_WP, 0.36797865_WP, 0.36824550_WP, 0.36851234_WP, 0.36877919_WP, 0.36904603_WP, 0.36931288_WP, 0.36957972_WP, 0.36984656_WP, 0.37011341_WP, 0.37038025_WP, 0.37064710_WP, 0.37091394_WP, 0.37118079_WP, 0.37144763_WP, 0.37171448_WP, 0.37198132_WP, 0.37224817_WP, 0.37251501_WP, 0.37278185_WP, 0.37304870_WP, 0.37331554_WP, 0.37358239_WP, 0.37384923_WP, 0.37411608_WP, 0.37438292_WP, 0.37464977_WP, 0.37491661_WP, 0.37518346_WP, 0.37545030_WP, 0.37571714_WP, 0.37598399_WP, 0.37625083_WP, 0.37651768_WP, 0.37678452_WP, 0.37705137_WP, 0.37731821_WP, 0.37758506_WP, 0.37785190_WP, 0.37811875_WP, 0.37838559_WP, 0.37865243_WP, 0.37891928_WP, 0.37918612_WP, 0.37945297_WP, 0.37971981_WP, 0.37998666_WP, 0.38025350_WP, 0.38052035_WP, 0.38078719_WP, 0.38105404_WP, 0.38132088_WP, 0.38158773_WP, 0.38185457_WP, 0.38212141_WP, 0.38238826_WP, 0.38265510_WP, 0.38292195_WP, 0.38318879_WP, 0.38345564_WP, 0.38372248_WP, 0.38398933_WP, 0.38425617_WP, 0.38452302_WP, 0.38478986_WP, 0.38505670_WP, 0.38532355_WP, 0.38559039_WP, 0.38585724_WP, 0.38612408_WP, 0.38639093_WP, 0.38665777_WP, 0.38692462_WP, 0.38719146_WP, 0.38745831_WP, 0.38772515_WP, 0.38799199_WP, 0.38825884_WP, 0.38852568_WP, 0.38879253_WP, 0.38905937_WP, 0.38932622_WP, 0.38959306_WP, 0.38985991_WP, 0.39012675_WP, 0.39039360_WP, 0.39066044_WP, 0.39092728_WP, 0.39119413_WP, 0.39146097_WP, 0.39172782_WP, 0.39199466_WP, 0.39226151_WP, 0.39252835_WP, 0.39279520_WP, 0.39306204_WP, 0.39332889_WP, 0.39359573_WP, 0.39386258_WP, 0.39412942_WP, 0.39439626_WP, 0.39466311_WP, 0.39492995_WP, 0.39519680_WP, 0.39546364_WP, 0.39573049_WP, 0.39599733_WP, 0.39626418_WP, 0.39653102_WP, 0.39679787_WP, 0.39706471_WP, 0.39733155_WP, 0.39759840_WP, 0.39786524_WP, 0.39813209_WP, 0.39839893_WP, 0.39866578_WP, 0.39893262_WP, 0.39919947_WP, 0.39946631_WP, 0.39973316_WP, 0.40000000_WP] 
      dt_dat = tdat(2) - tdat(1)
   end subroutine define_flowrate
   
   subroutine deallocate_flowrate
      implicit none
      deallocate(tdat, qdat)
   end subroutine deallocate_flowrate
   
   !> Compute massflow rate
   function get_bodyforce_mfr(srcU) result(mfr)
      use mpi_f08,  only: MPI_SUM,MPI_ALLREDUCE
      use parallel, only: MPI_REAL_WP
      real(WP), dimension(pipe%fs%cfg%imino_:,pipe%fs%cfg%jmino_:,pipe%fs%cfg%kmino_:), intent(in), optional :: srcU !< Needs to be (imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_)
      integer :: i,j,k,ierr
      real(WP) :: vol,myRhoU,myUvol,Uvol,mfr
      myRhoU=0.0_WP; myUvol=0.0_WP
      if (present(srcU)) then
         do k=pipe%fs%cfg%kmin_,pipe%fs%cfg%kmax_
            do j=pipe%fs%cfg%jmin_,pipe%fs%cfg%jmax_
               do i=pipe%fs%cfg%imin_,pipe%fs%cfg%imax_
                  vol=pipe%fs%cfg%dxm(i)*pipe%fs%cfg%dy(j)*pipe%fs%cfg%dz(k)*get_VF(i,j,k,'U')
                  myUvol=myUvol+vol
                  !myRhoU=myRhoU+vol*(2.0_WP*fs%U(i,j,k)-fs%Uold(i,j,k))*fs%rho+vol*srcU(i,j,k)
                  myRhoU=myRhoU+vol*(pipe%fs%rho*pipe%fs%U(i,j,k)+srcU(i,j,k))
               end do
            end do
         end do
      else
         do k=pipe%fs%cfg%kmin_,pipe%fs%cfg%kmax_
            do j=pipe%fs%cfg%jmin_,pipe%fs%cfg%jmax_
               do i=pipe%fs%cfg%imin_,pipe%fs%cfg%imax_
                  vol=pipe%fs%cfg%dxm(i)*pipe%fs%cfg%dy(j)*pipe%fs%cfg%dz(k)*get_VF(i,j,k,'U')
                  myUvol=myUvol+vol
                  !myRhoU=myRhoU+vol*(2.0_WP*fs%U(i,j,k)-fs%Uold(i,j,k))*fs%rho
                  myRhoU=myRhoU+vol*pipe%fs%rho*pipe%fs%U(i,j,k)
               end do
            end do
         end do
      end if
      call MPI_ALLREDUCE(myUvol,Uvol,1,MPI_REAL_WP,MPI_SUM,pipe%fs%cfg%comm,ierr)
      call MPI_ALLREDUCE(myRhoU,mfr ,1,MPI_REAL_WP,MPI_SUM,pipe%fs%cfg%comm,ierr); mfr=mfr/Uvol
   end function get_bodyforce_mfr

   !> Get volume fraction for direct forcing
   function get_VF(i,j,k,dir) result(VF)
      implicit none
      integer, intent(in)    :: i,j,k
      character(len=*)       :: dir
      real(WP)               :: VF
      real(WP)               :: r,eta,lam,delta,VFx,VFy,VFz
      real(WP), dimension(3) :: norm
      select case(trim(dir))
      case('U','u')
         delta=(pipe%cfg%dxm(i)*pipe%cfg%dy(j)*pipe%cfg%dz(k))**(1.0_WP/3.0_WP)
         r=sqrt(pipe%cfg%ym(j)**2+pipe%cfg%zm(k)**2)+epsilon(1.0_WP)
         norm(1)=0.0_WP; norm(2)=pipe%cfg%ym(j)/r; norm(3)=pipe%cfg%zm(k)/r
      case('V','v')
         delta=(pipe%cfg%dx(i)*pipe%cfg%dym(j)*pipe%cfg%dz(k))**(1.0_WP/3.0_WP)
         r=sqrt(pipe%cfg%y(j)**2+pipe%cfg%zm(k)**2)+epsilon(1.0_WP)
         norm(1)=0.0_WP; norm(2)=pipe%cfg%y(j)/r; norm(3)=pipe%cfg%zm(k)/r
      case('W','w')
         delta=(pipe%cfg%dx(i)*pipe%cfg%dy(j)*pipe%cfg%dzm(k))**(1.0_WP/3.0_WP)
         r=sqrt(pipe%cfg%ym(j)**2+pipe%cfg%z(k)**2)+epsilon(1.0_WP)
         norm(1)=0.0_WP; norm(2)=pipe%cfg%ym(j)/r; norm(3)=pipe%cfg%z(k)/r
      case default
         delta=(pipe%cfg%dx(i)*pipe%cfg%dy(j)*pipe%cfg%dz(k))**(1.0_WP/3.0_WP)
         r=sqrt(pipe%cfg%ym(j)**2+pipe%cfg%zm(k)**2)
         norm(1)=0.0_WP; norm(2)=pipe%cfg%ym(j)/r; norm(3)=pipe%cfg%zm(k)/r
      end select
      lam=sum(abs(norm)); eta=0.065_WP*(1.0_WP-lam**2)+0.39_WP
      VF=0.5_WP*(1.0_WP-tanh((r-0.5_WP*Djet)/(sqrt(2.0_WP)*lam*eta*delta+epsilon(1.0_WP))))
   end function get_VF
   
   !> Function that localizes the jet at -x
   function jet_loc(pg,i,j,k) result(isIn)
     use pgrid_class, only: pgrid
     implicit none
     class(pgrid), intent(in) :: pg
     integer, intent(in) :: i,j,k
     logical :: isIn
     real(WP) :: radius
     isIn = .false.
     ! Jet in yz plane
     radius=norm2([pg%ym(j),pg%zm(k)]-[0.0_WP,0.0_WP])
     !if (radius.le.0.5_WP*Djet.and.i.eq.pg%imin) isIn=.true.
     if (i.eq.pg%imin) isIn=.true.
   end function jet_loc

  !> Function that localizes the coflow at -x
   function coflow_loc(pg,i,j,k) result(isIn)
     use pgrid_class, only: pgrid
     implicit none
     class(pgrid), intent(in) :: pg
     integer, intent(in) :: i,j,k
     logical :: isIn
     real(WP) :: radius
     isIn=.false.
     ! Coflow in yz plane
     radius=norm2([pg%ym(j),pg%zm(k)]-[0.0_WP,0.0_WP])
     if (radius.gt.0.5_WP*Djet.and.i.eq.pg%imin) isIn=.true.
   end function coflow_loc

   !> Function that localizes the right (x+) of the domain
   function right_of_domain(pg,i,j,k) result(isIn)
     use pgrid_class, only: pgrid
     implicit none
     class(pgrid), intent(in) :: pg
     integer, intent(in) :: i,j,k
     logical :: isIn
     isIn=.false.
     if (i.eq.pg%imax+1) isIn=.true.
   end function right_of_domain
  
   !> Function that localizes the bottom (y-) of the domain
   function bottom_of_domain(pg,i,j,k) result(isIn)
     use pgrid_class, only: pgrid
     implicit none
     class(pgrid), intent(in) :: pg
     integer, intent(in) :: i,j,k
     logical :: isIn 
     isIn=.false.
     if (j.eq.pg%jmin) isIn=.true.
   end function bottom_of_domain

   !> Function that localizes the top (y+) of the domain
   function top_of_domain(pg,i,j,k) result(isIn)
     use pgrid_class, only: pgrid
     implicit none
     class(pgrid), intent(in) :: pg
     integer, intent(in) :: i,j,k
     logical :: isIn
     isIn=.false.
     if (j.eq.pg%jmax+1) isIn=.true.
   end function top_of_domain

   !> Function that localizes the front (z+) of the domain
   function front_of_domain(pg,i,j,k) result(isIn)
     use pgrid_class, only: pgrid
     implicit none
     class(pgrid), intent(in) :: pg
     integer, intent(in) :: i,j,k
     logical :: isIn
     isIn=.false.
     if (k.eq.pg%kmax+1) isIn=.true.
   end function front_of_domain
   
   !> Function that localizes the back (z-) of the domain
   function back_of_domain(pg,i,j,k) result(isIn)
     use pgrid_class, only: pgrid
     implicit none
     class(pgrid), intent(in) :: pg
     integer, intent(in) :: i,j,k
     logical :: isIn
     isIn=.false.
     if (k.eq.pg%kmin) isIn=.true.
   end function back_of_domain
  
   subroutine gendomain_allocate(d)
     implicit none
     class(gendomain), intent(inout) :: d
     integer :: imino_, imaxo_, jmino_, jmaxo_, kmino_, kmaxo_

     imino_ = d%cfg%imino_; imaxo_ = d%cfg%imaxo_;
     jmino_ = d%cfg%jmino_; jmaxo_ = d%cfg%jmaxo_;
     kmino_ = d%cfg%kmino_; kmaxo_ = d%cfg%kmaxo_;

     allocate(d%resU(imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_))
     allocate(d%resV(imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_))
     allocate(d%resW(imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_))
     allocate(d%Ui(imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_))
     allocate(d%Vi(imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_))
     allocate(d%Wi(imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_))
     allocate(d%SR(1:6,imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_))
     allocate(d%vort(1:3,imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_))
     allocate(d%gradu(1:3,1:3,imino_:imaxo_,jmino_:jmaxo_,kmino_:kmaxo_))
   end subroutine gendomain_allocate

   subroutine gendomain_deallocate(d)
      implicit none
      class(gendomain), intent(inout) :: d
      deallocate(d%resU, d%resV, d%resW)
      deallocate(d%Ui, d%Vi, d%Wi)
      deallocate(d%SR)
      deallocate(d%vort)
      deallocate(d%gradu)
    end subroutine gendomain_deallocate

     !> Monitor output shared between the two domains

   subroutine setup_gendom_monitors(d)
      implicit none
      class(gendomain), intent(inout) :: d

      ! Create simulation monitor
      d%mfile = monitor(d%fs%cfg%amRoot, trim(d%desc) // '_simulation')
      call d%mfile%add_column(time%n,'Timestep number')
      call d%mfile%add_column(time%t,'Time')
      call d%mfile%add_column(time%dt,'Timestep size')
      call d%mfile%add_column(time%cfl,'Maximum CFL')
      call d%mfile%add_column(d%fs%Umax,'Umax')
      call d%mfile%add_column(d%meanU,'Umean')
      call d%mfile%add_column(d%fs%Vmax,'Vmax')
      call d%mfile%add_column(d%meanV,'Vmean')
      call d%mfile%add_column(d%fs%Wmax,'Wmax')
      call d%mfile%add_column(d%meanW,'Wmean')
      call d%mfile%add_column(d%fs%Pmax,'Pmax')
      call d%mfile%add_column(d%fs%divmax,'Maximum divergence')
      call d%mfile%add_column(d%fs%psolv%it,'Pressure iteration')
      call d%mfile%add_column(d%fs%psolv%rerr,'Pressure error')
      call d%mfile%write()

      ! Create CFL monitor
      d%cflfile = monitor(d%fs%cfg%amRoot, trim(d%desc) // '_cfl')
      call d%cflfile%add_column(time%n,'Timestep number')
      call d%cflfile%add_column(time%t,'Time')
      call d%cflfile%add_column(d%fs%CFLc_x,'Convective xCFL')
      call d%cflfile%add_column(d%fs%CFLc_y,'Convective yCFL')
      call d%cflfile%add_column(d%fs%CFLc_z,'Convective zCFL')
      call d%cflfile%add_column(d%fs%CFLv_x,'Viscous xCFL')
      call d%cflfile%add_column(d%fs%CFLv_y,'Viscous yCFL')
      call d%cflfile%add_column(d%fs%CFLv_z,'Viscous zCFL')
      call d%cflfile%write()
   end subroutine setup_gendom_monitors

   subroutine write_gendom_monitors(d)
      implicit none
      class(gendomain), intent(inout) :: d
  
      call d%fs%get_max()
      call d%mfile%write()
      call d%cflfile%write()
  
    end subroutine write_gendom_monitors

   !> Initializes pjet domain stretched grid
   subroutine pjet_geometry_init()
      use sgrid_class, only: sgrid
      use param,       only: param_read
      use parallel,    only: group
      implicit none
      type(sgrid) :: grid
      
      ! Create a grid from input params
      create_grid: block
         use sgrid_class, only: cartesian
         integer :: i,nx,ny,nz
         logical :: stretch_x,stretch_y,stretch_z
         real(WP) :: Lx,Ly,Lz
         real(WP) :: xtilde,ytilde,ztilde
         real(WP) :: alpha,minAlpha,maxAlpha,r
         real(WP), dimension(:), allocatable :: x
         real(WP), dimension(:), allocatable :: y
         real(WP), dimension(:), allocatable :: z
         ! Read in grid definition
         call param_read('Jet diameter',Djet,default=0.1_WP)
         call param_read('Jet Lx',Lx)
         call param_read('Jet Ly',Ly)
         call param_read('Jet Lz',Lz)
         call param_read('Jet nx',nx)
         call param_read('Jet ny',ny)
         call param_read('Jet nz',nz)

         call param_read('Stretch x', stretch_x, default=.false.)
         call param_read('Stretch y', stretch_y, default=.false.)
         call param_read('Stretch z', stretch_z, default=.false.)

         call param_read('Stretch factor', r, default=2.0_WP)
         allocate(x(nx+1))
         allocate(y(ny+1))
         allocate(z(nz+1))
         ! Create simple rectilinear grid
         do i=1,nx+1
            if (stretch_x) then
               xtilde = 2.0_WP * real(i-1,WP) / real(nx-1,WP) - 1.0_WP
               alpha = 0.5_WP * (1.0_WP+sinh(r*xtilde))
               minAlpha = 0.5_WP * (1.0_WP + sinh(-r))
               maxAlpha = 0.5_WP * (1.0_WP + sinh(r))
               alpha = (alpha-minAlpha)/(maxAlpha-minAlpha)
               x(i) = Lx * alpha
            else
               x(i)=real(i-1,WP)/real(nx,WP)*Lx
            end if
         end do
         do i=1,ny+1
            if (stretch_y) then
               ytilde = 2.0_WP * real(i-1,WP) / real(ny-1,WP) - 1.0_WP
               alpha = 0.5_WP * (1.0_WP+sinh(r*ytilde))
               minAlpha = 0.5_WP * (1.0_WP + sinh(-r))
               maxAlpha = 0.5_WP * (1.0_WP + sinh(r))
               alpha = (alpha-minAlpha)/(maxAlpha-minAlpha)
               y(i) = Ly * alpha - 0.5_WP * Ly
            else
               y(i)=real(i-1,WP)/real(ny,WP)*Ly - 0.5_WP * Ly
            end if
         end do
         do i=1,nz+1
            if (stretch_z) then
               ztilde = 2.0_WP * real(i-1,WP) / real(nz-1,WP) - 1.0_WP
               alpha = 0.5_WP * (1.0_WP+sinh(r*ztilde))
               minAlpha = 0.5_WP * (1.0_WP + sinh(-r))
               maxAlpha = 0.5_WP * (1.0_WP + sinh(r))
               alpha = (alpha-minAlpha)/(maxAlpha-minAlpha)
               z(i) = Lz * alpha - 0.5_WP * Lz
            else
               z(i)=real(i-1,WP)/real(nz,WP)*Lz - 0.5_WP * Lz
            end if
         end do
         ! General serial grid object
         grid=sgrid(coord=cartesian,no=1,x=x,y=y,z=z,xper=.false.,yper=.true.,zper=.true.,name='jet')
         deallocate(x, y, z)
         ! Create partitioned grid
         pjet%cfg=config(grp=group,decomp=pjetpart,grid=grid)
         pjet%cfg%VF=1.0_WP
      end block create_grid
   end subroutine pjet_geometry_init
   
   !> Initialization of pjet solver
   subroutine pjet_init
      use param, only: param_read
      use messager, only: log
      implicit none

      ! Create a single-phase flow solver without bconds
      create_and_initialize_flow_solver: block
         use hypre_str_class, only: smg,pcg_pfmg,pfmg,gmres_smg
         ! use fft2d_class,     only: fft2d
         use incomp_class,    only: clipped_neumann, dirichlet, slip
         ! Create flow solver
         pjet%fs=incomp(cfg=pjet%cfg,name='NS solver')
         ! Get jet diameter
         theta = Djet / 20.0_WP
         call param_read('Flow rate',Q0,default=0.001_WP)
         call param_read('Pulse frequency',omegaj,default=1.0_WP)
         call param_read('Pulse decay time',tauj,default=0.2_WP)
         call param_read('Coflow velocity',Uco,default=0.46_WP)
         ! Add BCs
         call pjet%fs%add_bcond(name='jet',   type=dirichlet,locator=jet_loc,face='x',dir=-1,canCorrect=.false. )
         call pjet%fs%add_bcond(name='right', type=clipped_neumann,locator=right_of_domain,face='x',dir=+1,canCorrect=.true.)
         !call pjet%fs%add_bcond(name='bottom',type=slip, locator=bottom_of_domain,face='y',dir=-1,canCorrect=.false.)
         !call pjet%fs%add_bcond(name='top',   type=slip, locator=top_of_domain,face='y',dir=+1,canCorrect=.false.)
         !call pjet%fs%add_bcond(name='front', type=slip, locator=front_of_domain,face='z',dir=+1,canCorrect=.false.)
         !call pjet%fs%add_bcond(name='back',  type=slip, locator=back_of_domain,face='z',dir=-1,canCorrect=.false.)
         ! Assign constant viscosity
         call param_read('Dynamic viscosity',visc); pjet%fs%visc=visc
         ! Assign constant density
         call param_read('Density',pjet%fs%rho)
         ! Prepare and configure pressure solver
         pjet%vs=ddadi(cfg=pjet%cfg,name='Velocity',nst=7)
         pjet%ps=hypre_str(cfg=pjet%cfg,name='Pressure',method=gmres_smg,nst=7)
         ! pjet%ps=fft2d(cfg=pjet%cfg,name='Pressure',nst=7)
         call param_read('Pressure iteration',pjet%ps%maxit)
         call param_read('Pressure tolerance',pjet%ps%rcvg)
         ! Setup the solver
         call pjet%fs%setup(pressure_solver=pjet%ps, implicit_solver=pjet%vs)
      end block create_and_initialize_flow_solver

      ! Prepare initial velocity field
      initialize_velocity: block
         use incomp_class, only: bcond
         use random,   only: random_normal
         use mpi_f08,  only: MPI_ALLREDUCE,MPI_SUM
         use parallel, only: MPI_REAL_WP
         use mathtools,only: Pi
         type(bcond), pointer :: mybc
         integer :: i,j,k,n
         real(WP) :: r
         
         Qt = qdat(1)
         U0 = Qt / (Pi * Djet**2 / 4.0_WP) * 1.667E-05_WP 
         Uco = 0.05_WP * U0
         
         pjet%fs%U = 0.0_WP
         pjet%fs%V = 0.0_WP
         pjet%fs%W = 0.0_WP

         ! pjet%fs%U=0.0_WP; pjet%fs%V=0.0_WP; pjet%fs%W=0.0_WP
         ! call pjet%fs%get_bcond('jet', mybc)
         ! do n=1,mybc%itr%no_
         !    i=mybc%itr%map(1,n); j=mybc%itr%map(2,n); k=mybc%itr%map(3,n)
         !    r = norm2([pjet%fs%cfg%ym(j), pjet%fs%cfg%zm(k)])
         !    pjet%fs%U(i,j,k) = 0.5_WP * (U0 + Uco) + 0.5_WP * (U0 - Uco) * TANH(0.5_WP * (0.5_WP * Djet - r) / theta)
         ! end do

         call pjet%fs%get_mfr()
         call pjet%fs%correct_mfr()
         call pjet%fs%interp_vel(pjet%Ui,pjet%Vi,pjet%Wi)
         call pjet%fs%get_vorticity(pjet%vort)

         pjet%desc = 'pjet'
      end block initialize_velocity

   end subroutine pjet_init

   !> Initialization of problem solver
   subroutine pipe_init
      use param, only: param_read
      implicit none

      ! Create an incompressible flow solver without bconds
      create_flow_solver: block
         use hypre_str_class, only: pcg_pfmg
         ! Create flow solver
         pipe%fs=incomp(cfg=pipe%cfg,name='Incompressible NS')
         ! Set the flow properties
         call param_read('Density',pipe%fs%rho)
         call param_read('Dynamic viscosity',visc); pipe%fs%visc=visc
         ! Configure pressure solver
         pipe%ps=fft3d(cfg=pipe%cfg,name='Pressure',nst=7)
         !ps=hypre_str(cfg=cfg,name='Pressure',method=pcg_pfmg,nst=7)
         !ps%maxlevel=14
         !call param_read('Pressure iteration',ps%maxit)
         !call param_read('Pressure tolerance',ps%rcvg)
         ! Configure implicit velocity solver
         pipe%vs=hypre_str(cfg=pipe%cfg,name='Velocity',method=pcg_pfmg,nst=7)
         !call param_read('Implicit iteration',pipe%vs%maxit)
         !call param_read('Implicit tolerance',pipe%vs%rcvg)
         ! Setup the solver
         call pipe%fs%setup(pressure_solver=pipe%ps,implicit_solver=pipe%vs)
      end block create_flow_solver
      
      ! Allocate work arrays
      allocate_work_arrays: block
         allocate(pipe%G   (pipe%cfg%imino_:pipe%cfg%imaxo_,pipe%cfg%jmino_:pipe%cfg%jmaxo_,pipe%cfg%kmino_:pipe%cfg%kmaxo_))
      end block allocate_work_arrays
      
      ! Initialize our velocity field
      initialize_velocity: block
         use mathtools, only: twoPi
         use random,    only: random_uniform
         integer :: i,j,k
         pipe%fs%U = 0.5_WP
         pipe%fs%V = 0.0_WP
         pipe%fs%W = 0.0_WP
         ! ! Handle restart/saves here
         ! pipeic: block
         !    character(len=str_medium) :: timestamp
         !    ! Create event for saving restart files
         !    ! Check if we are restarting
         !    call param_read(tag='Pipe IC File',val=timestamp,short='r',default='')
         !    ! Read the datafile
         !    df=datafile(pg=pipe%cfg,fdata='pipe_ic/data_'//trim(adjustl(timestamp)))
         ! end block pipeic
         !
         ! call df%pullval(name='dt',val=time%dt)
         ! call df%pullvar(name='U',var=pipe%fs%U)
         ! call df%pullvar(name='V',var=pipe%fs%V)
         ! call df%pullvar(name='W',var=pipe%fs%W)
         ! call df%pullvar(name='P',var=pipe%fs%P)
         
         call pipe%fs%cfg%sync(pipe%fs%U)
         call pipe%fs%cfg%sync(pipe%fs%V)
         call pipe%fs%cfg%sync(pipe%fs%W)
         ! Compute cell-centered velocity
         call pipe%fs%interp_vel(pipe%Ui,pipe%Vi,pipe%Wi)
         ! Compute divergence
         call pipe%fs%get_div()
         call pipe%fs%get_vorticity(pipe%vort)
         ! Get target MFR and zero bodyforce
         pipe%mfr=get_bodyforce_mfr()
         pipe%mfr_target=pipe%mfr
         pipe%bforce=0.0_WP
      end block initialize_velocity
      
      ! Initialize IBM fields
      initialize_ibm: block
         integer :: i,j,k
         do k=pipe%fs%cfg%kmino_,pipe%fs%cfg%kmaxo_
            do j=pipe%fs%cfg%jmino_,pipe%fs%cfg%jmaxo_
               do i=pipe%fs%cfg%imino_,pipe%fs%cfg%imaxo_
                  pipe%G(i,j,k)=0.5_WP*Djet-sqrt(pipe%fs%cfg%ym(j)**2+pipe%fs%cfg%zm(k)**2)
               end do
            end do
         end do
      end block initialize_ibm
      pipe%desc = 'pipe'
      
   end subroutine pipe_init
   
   !> Initialization of problem geometry
   subroutine pipe_geometry_init()
      use sgrid_class, only: sgrid
      use param,       only: param_read
      implicit none
      type(sgrid) :: grid
      
      ! Create a grid from input params
      create_grid: block
         use sgrid_class, only: cartesian
         integer :: i,j,k,nx,ny,nz,no
         real(WP) :: Lx,Ly,Lz,dx,overlap
         real(WP), dimension(:), allocatable :: x,y,z
       
         ! Read in grid definition
         call param_read('Jet diameter', Djet)
         call param_read('Pipe length',Lx)
         call param_read('Overlap', overlap)
         call param_read('Pipe nx',nx); allocate(x(nx+1))
         call param_read('Pipe ny',ny); allocate(y(ny+1))
         call param_read('Pipe nz',nz); allocate(z(nz+1))
          
         dx=Lx/real(nx,WP)
         no=6
         if (ny.gt.1) then
            Ly=Djet+real(2*no,WP)*Djet/real(ny-2*no,WP)
         else
            Ly=dx
         end if
         if (nz.gt.1) then
            Lz=Djet+real(2*no,WP)*Djet/real(ny-2*no,WP)
         else
            Lz=dx
         end if
         
         ! Create simple rectilinear grid
         do i=1,nx+1
            x(i)=real(i-1,WP)/real(nx,WP)*Lx - Lx + overlap
         end do
         do j=1,ny+1
            y(j)=real(j-1,WP)/real(ny,WP)*Ly-0.5_WP*Ly
         end do
         do k=1,nz+1
            z(k)=real(k-1,WP)/real(nz,WP)*Lz-0.5_WP*Lz
         end do

         ! General serial grid object
         grid=sgrid(coord=cartesian,no=2,x=x,y=y,z=z,xper=.true.,yper=.true.,zper=.true.,name='pipe')
         deallocate(x, y, z)
      end block create_grid
      
      ! Create a config from that grid on our entire group
      create_cfg: block
         use parallel, only: group
         ! Create partitioned grid
         pipe%cfg=config(grp=pipegrp,decomp=pipepart,grid=grid)
      end block create_cfg
      
      ! Create masks for this config
      create_walls: block
         integer :: i,j,k
         do k=pipe%cfg%kmin_,pipe%cfg%kmax_
            do j=pipe%cfg%jmin_,pipe%cfg%jmax_
               do i=pipe%cfg%imin_,pipe%cfg%imax_
                  pipe%cfg%VF(i,j,k)=max(get_VF(i,j,k,'SC'),epsilon(1.0_WP))
               end do
            end do
         end do
         call pipe%cfg%sync(pipe%cfg%VF)
         call pipe%cfg%calc_fluid_vol()
      end block create_walls
   end subroutine pipe_geometry_init 

   !> ENSIGHT ROUTINES 
   subroutine setup_ens(d)
      implicit none
      class(gendomain), intent(inout) :: d
      d%ens_out = ensight(cfg=d%cfg, name=trim(d%desc))
      call d%ens_out%add_vector('velocity', d%Ui, d%Vi, d%Wi)
      call d%ens_out%add_vector('vorticity', d%vort(1,:,:,:), d%vort(2,:,:,:), d%vort(3,:,:,:))
      call d%ens_out%add_scalar('pressure', d%fs%P)
   end subroutine setup_ens

   subroutine write_ens(d)
      implicit none
      class(gendomain), intent(inout) :: d
      integer :: i
      call d%fs%interp_vel(d%Ui, d%Vi, d%Wi)
      call d%fs%get_vorticity(d%vort)
      call d%ens_out%write_data(time%t)
   end subroutine write_ens

   !> Initialization of problem solver
   subroutine simulation_init
      use param,     only: param_read
      use parallel,  only: group, comm, nproc, rank
      implicit none
      integer :: n, npipe, npjet, ierr, rr

      call param_read('Pipe Partition',pipepart,short='p')
      call param_read('Jet Partition' ,pjetpart,short='p')

      npipe = product(pipepart); npjet = product(pjetpart)
      n = nproc

      ! Setup separate domain partitions
      call MPI_GROUP_INCL(group, npipe, [0,npipe-1,1], pipegrp, ierr)
      ! call MPI_GROUP_INCL(group, npjet, [npipe,n-1,1], pjetgrp, ierr)

      ! call MPI_GROUP_RANK(pjetgrp, pjetRank, ierr)
      call MPI_GROUP_RANK(pipegrp, pipeRank, ierr)

      call allocate_flowrate()
      call define_flowrate()

      dom_cpl = coupler(src_grp=pipegrp, dst_grp=group,name='Domain Coupler')
      
      call pjet_geometry_init()
      call gendomain_allocate(pjet)
      call pjet_init()
      call setup_gendom_monitors(pjet)
      call setup_ens(pjet)
      call dom_cpl%set_dst(pjet%cfg)
      inpipeGrp = .false. 
      if (pipeRank /= MPI_UNDEFINED) then
         inpipeGrp = .true.
         call pipe_geometry_init()
         call gendomain_allocate(pipe)
         call pipe_init()
         call setup_gendom_monitors(pipe)
         call setup_ens(pipe)
         call dom_cpl%set_src(pipe%cfg)
      end if
      call dom_cpl%initialize()
      
      ! Initialize time tracker with 2 subiterations
      initialize_timetracker: block
         time=timetracker(amRoot=amRoot)
         call param_read('Max timestep size',time%dtmax)
         call param_read('Max cfl number',time%cflmax)
         call param_read('Max iter',time%nmax)
         time%dt=time%dtmax
         time%itmax=2
      end block initialize_timetracker

   end subroutine simulation_init
   
   
   !> Time integrate our problem
   subroutine simulation_run
      use parallel,       only: parallel_time
      implicit none
      integer :: ii, it
      real(WP) :: pipeCFL, pjetCFL
      ! Perform time integration
      do while (.not.time%done())
         
         ! Increment time
         ! call pipe%fs%get_cfl(time%dt,pipe%cfl)
         call pjet%fs%get_cfl(time%dt,pjet%cfl)
         !time%cfl = max(pipe%cfl, pjet%cfl)
         time%cfl = pjet%cfl 
         call time%adjust_dt()
         call time%increment()

         !! PIPE STEP
         if (inpipeGrp) then
          ! Remember old velocity
          pipe%fs%Uold=pipe%fs%U
          pipe%fs%Vold=pipe%fs%V
          pipe%fs%Wold=pipe%fs%W
          
          ! Perform sub-iterations
          do it = 1, time%itmax
             ! Build mid-time velocity
             pipe%fs%U=0.5_WP*(pipe%fs%U+pipe%fs%Uold)
             pipe%fs%V=0.5_WP*(pipe%fs%V+pipe%fs%Vold)
             pipe%fs%W=0.5_WP*(pipe%fs%W+pipe%fs%Wold)
             
             ! Explicit calculation of drho*u/dt from NS
             call pipe%fs%get_dmomdt(pipe%resU,pipe%resV,pipe%resW)
             
             ! Assemble explicit residual
             pipe%resU=-2.0_WP*(pipe%fs%rho*pipe%fs%U-pipe%fs%rho*pipe%fs%Uold)+time%dt*pipe%resU
             pipe%resV=-2.0_WP*(pipe%fs%rho*pipe%fs%V-pipe%fs%rho*pipe%fs%Vold)+time%dt*pipe%resV
             pipe%resW=-2.0_WP*(pipe%fs%rho*pipe%fs%W-pipe%fs%rho*pipe%fs%Wold)+time%dt*pipe%resW
             
             ! Add body forcing
             bodyforcing: block
                real(WP) :: mfr
                pipe%mfr=get_bodyforce_mfr(pipe%resU)
                pipe%bforce=(pipe%mfr_target-pipe%mfr)/time%dtmid
                pipe%resU=pipe%resU+time%dt*pipe%bforce
             end block bodyforcing

             ! Form implicit residuals
             call pipe%fs%solve_implicit(time%dt,pipe%resU,pipe%resV,pipe%resW)
             
             ! Apply these residuals
             pipe%fs%U=2.0_WP*pipe%fs%U-pipe%fs%Uold+pipe%resU
             pipe%fs%V=2.0_WP*pipe%fs%V-pipe%fs%Vold+pipe%resV
             pipe%fs%W=2.0_WP*pipe%fs%W-pipe%fs%Wold+pipe%resW
             
             ! Apply IB forcing to enforce BC at the pipe walls
             ibforcing: block
                integer :: i,j,k
                do k=pipe%fs%cfg%kmin_,pipe%fs%cfg%kmax_
                   do j=pipe%fs%cfg%jmin_,pipe%fs%cfg%jmax_
                      do i=pipe%fs%cfg%imin_,pipe%fs%cfg%imax_
                         pipe%fs%U(i,j,k)=get_VF(i,j,k,'U')*pipe%fs%U(i,j,k)
                         pipe%fs%V(i,j,k)=get_VF(i,j,k,'V')*pipe%fs%V(i,j,k)
                         pipe%fs%W(i,j,k)=get_VF(i,j,k,'W')*pipe%fs%W(i,j,k)
                      end do
                   end do
                end do
                call pipe%fs%cfg%sync(pipe%fs%U)
                call pipe%fs%cfg%sync(pipe%fs%V)
                call pipe%fs%cfg%sync(pipe%fs%W)
             end block ibforcing
            
             ! Apply other boundary conditions on the resulting fields
             call pipe%fs%apply_bcond(time%t,time%dt)
             
             ! Solve Poisson equation
             call pipe%fs%correct_mfr()
             call pipe%fs%get_div()
             pipe%fs%psolv%rhs=-pipe%fs%cfg%vol*pipe%fs%div*pipe%fs%rho/time%dt
             pipe%fs%psolv%sol=0.0_WP
             call pipe%fs%psolv%solve()
             call pipe%fs%shift_p(pipe%fs%psolv%sol)
             
             ! Correct velocity
             call pipe%fs%get_pgrad(pipe%fs%psolv%sol,pipe%resU,pipe%resV,pipe%resW)
             pipe%fs%P=pipe%fs%P+pipe%fs%psolv%sol
             pipe%fs%U=pipe%fs%U-time%dt*pipe%resU/pipe%fs%rho
             pipe%fs%V=pipe%fs%V-time%dt*pipe%resV/pipe%fs%rho
             pipe%fs%W=pipe%fs%W-time%dt*pipe%resW/pipe%fs%rho
         
          end do
         end if

         ! Inflow coupling
         if (inpipeGrp) then
            call dom_cpl%push(pipe%fs%U)
         end if
         call dom_cpl%transfer()
         call dom_cpl%pull(pjet%resU)

         if (inpipeGrp) then
            call dom_cpl%push(pipe%fs%V)
         end if
         call dom_cpl%transfer()
         call dom_cpl%pull(pjet%resV)

         if (inpipeGrp) then
            call dom_cpl%push(pipe%fs%W)
         end if
         call dom_cpl%transfer()
         call dom_cpl%pull(pjet%resW)

         !! PJET STEP
         apply_inflow_vals: block
           if (pjet%cfg%imin .eq. pjet%cfg%imin_) then
             pjet%fs%U(pjet%cfg%imino_:pjet%cfg%imin_,:,:) = pjet%resU(pjet%cfg%imino_:pjet%cfg%imin_,:,:)
             pjet%fs%V(pjet%cfg%imino_:pjet%cfg%imin_-1,:,:) = pjet%resV(pjet%cfg%imino_:pjet%cfg%imin_-1,:,:)
             pjet%fs%W(pjet%cfg%imino_:pjet%cfg%imin_-1,:,:) = pjet%resW(pjet%cfg%imino_:pjet%cfg%imin_-1,:,:)
           end if
         end block apply_inflow_vals

         call pjet%fs%apply_bcond(time%t, time%dt)
         ! Remember old velocity
         pjet%fs%Uold=pjet%fs%U
         pjet%fs%Vold=pjet%fs%V
         pjet%fs%Wold=pjet%fs%W
         
         ! Perform sub-iterations
         do it = 1, time%itmax
            ! Build mid-time velocity
            pjet%fs%U=0.5_WP*(pjet%fs%U+pjet%fs%Uold)
            pjet%fs%V=0.5_WP*(pjet%fs%V+pjet%fs%Vold)
            pjet%fs%W=0.5_WP*(pjet%fs%W+pjet%fs%Wold)
            
            ! Explicit calculation of drho*u/dt from NS
            call pjet%fs%get_dmomdt(pjet%resU,pjet%resV,pjet%resW)

            ! Assemble explicit residual
            pjet%resU=-2.0_WP*(pjet%fs%rho*pjet%fs%U-pjet%fs%rho*pjet%fs%Uold)+time%dt*pjet%resU
            pjet%resV=-2.0_WP*(pjet%fs%rho*pjet%fs%V-pjet%fs%rho*pjet%fs%Vold)+time%dt*pjet%resV
            pjet%resW=-2.0_WP*(pjet%fs%rho*pjet%fs%W-pjet%fs%rho*pjet%fs%Wold)+time%dt*pjet%resW

            ! Implicit velocity solve
            call pjet%fs%solve_implicit(time%dt,pjet%resU,pjet%resV,pjet%resW)

            ! Apply these residuals
            pjet%fs%U=2.0_WP*pjet%fs%U-pjet%fs%Uold+pjet%resU
            pjet%fs%V=2.0_WP*pjet%fs%V-pjet%fs%Vold+pjet%resV
            pjet%fs%W=2.0_WP*pjet%fs%W-pjet%fs%Wold+pjet%resW

            ! dirichlet_velocity: block
            !    use incomp_class, only: bcond
            !    use mathtools,    only: Pi
            !    type(bcond), pointer :: mybc
            !    integer :: n,i,j,k,jn,jp
            !    real(WP) :: r
            !
            !    jn = FLOOR(time%t/dt_dat) + 1
            !    jp = jn + 1;
            !    
            !    ! Linear interpolation of provided flow rate data
            !    if (jp.lt.1500) then
            !       Qt = (qdat(jp) - qdat(jn)) / (tdat(jp) - tdat(jn)) * (time%t - tdat(jn)) + qdat(jn) 
            !       U0 = Qt / (Pi * Djet**2 / 4.0_WP) * 1.667E-05_WP 
            !       Uco = 0.05_WP * U0
            !    else
            !       U0 = qdat(1500) / (Pi * Djet**2 / 4.0_WP) * 1.667E-05_WP 
            !       Uco = 0.05_WP * U0
            !    end if
            ! end block dirichlet_velocity
             
            ! Apply other boundary conditions on the resulting fields
            call pjet%fs%apply_bcond(time%t,time%dt)

            ! Solve Poisson equation
            call pjet%fs%get_mfr()
            call pjet%fs%correct_mfr()
            call pjet%fs%get_div()
            pjet%fs%psolv%rhs=-pjet%fs%cfg%vol*pjet%fs%div*pjet%fs%rho/time%dt
            pjet%fs%psolv%sol=0.0_WP
            call pjet%fs%psolv%solve()
            call pjet%fs%shift_p(pjet%fs%psolv%sol)
            
            ! Correct velocity
            call pjet%fs%get_pgrad(pjet%fs%psolv%sol,pjet%resU,pjet%resV,pjet%resW)
            pjet%fs%P=pjet%fs%P+pjet%fs%psolv%sol
            pjet%fs%U=pjet%fs%U-time%dt*pjet%resU/pjet%fs%rho
            pjet%fs%V=pjet%fs%V-time%dt*pjet%resV/pjet%fs%rho
            pjet%fs%W=pjet%fs%W-time%dt*pjet%resW/pjet%fs%rho

         end do
         
         ! Recompute interpolated velocity and divergence
         call pjet%fs%interp_vel(pjet%Ui,pjet%Vi,pjet%Wi)
         call pjet%fs%get_div()
         if (inpipeGrp) then
            call write_gendom_monitors(pipe)
            call write_ens(pipe)
         end if
         call write_gendom_monitors(pjet)
         call write_ens(pjet)
         
      end do
   end subroutine simulation_run
   
   
   !> Finalize the NGA2 simulation
   subroutine simulation_final
      implicit none
      
      call gendomain_deallocate(pjet)
      call gendomain_deallocate(pipe)
      call deallocate_flowrate()
   end subroutine simulation_final
   
end module simulation
